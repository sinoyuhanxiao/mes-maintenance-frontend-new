import"../vue/vue.Dfo81L2Q.js";import{i as A,e as L}from"../echarts/echarts.DOymG6Ya.js";import{_ as z}from"../../assets/index-CE-d1vf_.js";import{c as M,o as E,r,q as w,w as T,am as O,a as p,O as Q,S as o,L as u,_ as k,Q as S,R}from"../@vue/@vue.CVGyaoMH.js";import{M as j}from"../MaintenanceCardTable/MaintenanceCardTable.Be9AhfwI.js";import{s as I}from"../work-order/work-order.DahU_I_M.js";import"../tslib/tslib.BDyQ-Jie.js";import"../zrender/zrender.DldvXODt.js";import"../element-plus/element-plus.CU5xiOkY.js";import"../lodash-es/lodash-es.BLHqGvLj.js";import"../@element-plus/@element-plus.BNeHluFm.js";import"../@popperjs/@popperjs.D_chPuIy.js";import"../@ctrl/@ctrl.r5W6hzzQ.js";import"../dayjs/dayjs.C0sY0_St.js";import"../async-validator/async-validator.D3FX-SGt.js";import"../memoize-one/memoize-one.BdPwpGay.js";import"../normalize-wheel-es/normalize-wheel-es.BQoi3Ox2.js";import"../@floating-ui/@floating-ui.85_40PfK.js";import"../pinia/pinia.CzPcBe5J.js";import"../vue-demi/vue-demi.-dVQ4Px2.js";import"../js-cookie/js-cookie.Cz0CWeBA.js";import"../geotiff/geotiff.Dp1pzeXC.js";import"../vue-router/vue-router.30cuaQZO.js";import"../path-to-regexp/path-to-regexp.i8-bKtXe.js";import"../fuse.js/fuse.js.BiDyM4rQ.js";import"../path-browserify/path-browserify.DkEToxTs.js";import"../screenfull/screenfull.DmVOzVZz.js";import"../vue-i18n/vue-i18n.DjO1PVT4.js";import"../@intlify/@intlify.BhOIvmlS.js";import"../mitt/mitt.DJ65BbbF.js";import"../@vueuse/@vueuse.B5lT-MN9.js";import"../axios/axios.Dq7h7Pqt.js";import"../nprogress/nprogress._Z8YfKSV.js";/* empty css                                 */import"../clipboard/clipboard.DAe4Lk7l.js";import"../vue3-lottie/vue3-lottie.DS19j_I8.js";import"../lottie-web/lottie-web.fKmgUVyQ.js";import"../MaintenanceWorkOrderCard/MaintenanceWorkOrderCard.CWj1vAV1.js";import"../datetime/datetime.39-ZCqKU.js";const N={__name:"PieChart",props:{chartData:Array,chartTitle:String},setup(n,{expose:a}){a();const i=n,e=r(null);let t=null;const s=()=>{e.value&&(t||(t=A(e.value)),t.setOption({tooltip:{trigger:"item"},title:{text:i.chartTitle,left:"center",top:"5%",textStyle:{fontSize:14}},legend:{top:"20%",left:"center"},series:[{name:"Work Order Priority",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,padAngle:5,itemStyle:{borderRadius:10},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:18,fontWeight:"bold"}},labelLine:{show:!1},data:i.chartData,top:"30%"}]}))};w(()=>{s()}),T(()=>i.chartData,()=>{s()},{deep:!0});const l={props:i,chartRef:e,get chartInstance(){return t},set chartInstance(c){t=c},renderChart:s,ref:r,onMounted:w,watch:T,get echarts(){return L}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}},V={ref:"chartRef",style:{width:"400px",height:"230px"}};function B(n,a,i,e,t,s){return E(),M("div",V,null,512)}const q=z(N,[["render",B],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/components/Charts/PieChart.vue"]]),F=10,G=5,H={__name:"WorkOrderDashboard",setup(n,{expose:a}){a();const i=r("300px"),e=r("540px"),t=r([]),s=r([]),l=r([]),c=r([]),m=r(0),x=r(0),D=r(null),_=k({page:1,limit:10,sort:"-id"}),g=k({page:1,limit:5,sort:"-id"});async function f(){const d=await I(_.page,_.limit,"createdAt","DESC"),W=await I(g.page,g.limit,"createdAt","DESC");t.value=d.data.content,s.value=W.data.content,m.value=d.data.totalElements,x.value=W.data.totalElements,D.value=t.value[0];const v={},C={};for(const h of t.value)if(h.status===1){const b=h.priority.id;v[b]||(v[b]={value:0,name:h.priority.name}),v[b].value+=1;const y=h.state.id;C[y]||(C[y]={value:0,name:h.state.name}),C[y].value+=1}l.value=Object.values(v),c.value=Object.values(C)}f();const P={height:i,height2:e,items:t,incompleteItems:s,grouped:l,groupedStates:c,totalItems:m,incompleteTotalItems:x,selectedData:D,listQuery:_,incompleteListQuery:g,getAllWorkOrdersData:f,handleCurrentChange:d=>{_.page=d,f()},handleCurrentChangeIncomplete:d=>{g.page=d,f()},pageSize:F,incompletePageSize:G,ref:r,reactive:k,PieChart:q,MaintenanceCardTable:j,get searchWorkOrders(){return I}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}},J={class:"page-layout"},K={class:"header-title"},U={class:"dashboard-body"},X={class:"left-container"},Y={class:"right-container"},Z={class:"pie-chart-container"},$={class:"right-table"};function ee(n,a,i,e,t,s){const l=O("el-button"),c=O("el-text"),m=O("el-card");return E(),M("div",J,[p("div",K,[Q(' <el-text style="font-size: 20px; color: #181818">Work Order Dashboard</el-text> '),o(l,{class:"filter-item",type:"primary",icon:n.EditPen,onClick:n.handleCreateWorkOrder,"aria-label":n.$t("workOrder.actions.createWorkOrder")},{default:u(()=>[S(R(n.$t("workOrder.actions.createWorkOrder")),1)]),_:1},8,["icon","onClick","aria-label"])]),p("div",U,[p("div",X,[o(m,{style:{flex:"1"}},{default:u(()=>[o(c,{tag:"b"},{default:u(()=>a[0]||(a[0]=[S("Work Orders Due Today (5)")])),_:1,__:[0]}),o(e.MaintenanceCardTable,{style:{flex:"1"},items:e.items,pageSize:e.pageSize,module:parseInt(1),height:e.height,totalItems:e.totalItems,handleCurrentChange:e.handleCurrentChange,currentPage:e.listQuery.page},null,8,["items","module","height","totalItems","currentPage"])]),_:1})]),p("div",Y,[p("div",Z,[o(e.PieChart,{chartData:e.grouped,chartTitle:"Work Orders by Priority"},null,8,["chartData"]),o(e.PieChart,{chartData:e.groupedStates,chartTitle:"Work Orders by State"},null,8,["chartData"])]),p("div",$,[o(m,null,{default:u(()=>[o(c,{tag:"b"},{default:u(()=>a[1]||(a[1]=[S("Incomplete Work Orders")])),_:1,__:[1]}),o(e.MaintenanceCardTable,{items:e.incompleteItems,pageSize:e.incompletePageSize,module:parseInt(1),height:e.height2,totalItems:e.incompleteTotalItems,handleCurrentChange:e.handleCurrentChangeIncomplete,currentPage:e.incompleteListQuery.page},null,8,["items","module","height","totalItems","currentPage"])]),_:1})])])])])}const Be=z(H,[["render",ee],["__scopeId","data-v-f802f746"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/workOrder/components/WorkOrderDashboard.vue"]]);export{Be as default};
