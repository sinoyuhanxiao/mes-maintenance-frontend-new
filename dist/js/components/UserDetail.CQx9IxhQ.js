import"../vue/vue.Dfo81L2Q.js";import{u as X,a as Z}from"../vue-router/vue-router.30cuaQZO.js";import{g as $,a as ee,c as te}from"../user/user.62TZfaxK.js";import{ao as ne,Y as de,$ as ce}from"../@element-plus/@element-plus.BNeHluFm.js";import{_ as me,u as ie}from"../../assets/index-fCswSekQ.js";import{u as se}from"../vue-i18n/vue-i18n.DjO1PVT4.js";import{U as ue}from"../UserForm/UserForm.BhVjU_8z.js";import{c as re}from"../element-plus/element-plus.CU5xiOkY.js";import{am as m,as as _e,c as u,a as t,S as i,O as p,L as s,R as r,F as U,a8 as k,r as b,q as oe,o as n,Q as d,K as L,M as pe}from"../@vue/@vue.CVGyaoMH.js";import"../pinia/pinia.CzPcBe5J.js";import"../vue-demi/vue-demi.-dVQ4Px2.js";import"../js-cookie/js-cookie.Cz0CWeBA.js";import"../geotiff/geotiff.Dp1pzeXC.js";import"../path-to-regexp/path-to-regexp.i8-bKtXe.js";import"../fuse.js/fuse.js.BiDyM4rQ.js";import"../path-browserify/path-browserify.DkEToxTs.js";import"../screenfull/screenfull.DmVOzVZz.js";import"../mitt/mitt.DJ65BbbF.js";import"../lodash-es/lodash-es.BLHqGvLj.js";import"../@vueuse/@vueuse.B5lT-MN9.js";import"../axios/axios.Dq7h7Pqt.js";import"../nprogress/nprogress._Z8YfKSV.js";/* empty css                                 */import"../clipboard/clipboard.DAe4Lk7l.js";import"../vue3-lottie/vue3-lottie.DS19j_I8.js";import"../lottie-web/lottie-web.fKmgUVyQ.js";import"../@popperjs/@popperjs.D_chPuIy.js";import"../@ctrl/@ctrl.r5W6hzzQ.js";import"../dayjs/dayjs.C0sY0_St.js";import"../async-validator/async-validator.D3FX-SGt.js";import"../memoize-one/memoize-one.BdPwpGay.js";import"../normalize-wheel-es/normalize-wheel-es.BQoi3Ox2.js";import"../@floating-ui/@floating-ui.85_40PfK.js";import"../@intlify/@intlify.BhOIvmlS.js";import"../FileUploadMultiple/FileUploadMultiple.XhmJ4C99.js";import"../vue-tel-input/vue-tel-input.B5InR4bt.js";import"../libphonenumber-js/libphonenumber-js.7pCTNi9u.js";import"../minio/minio.DwZpSMzM.js";const fe={__name:"UserDetail",setup(le,{expose:c}){c();const{t:P}=se(),e=X(),F=Z(),I=ie(),D=b([]),y=b([]),C=b(!1),f=b(!1),a=b(null),h=b(null);oe(async()=>{const _=parseInt(e.params.id);h.value=isNaN(_)?parseInt(I.uid):_,await w(h.value);const g=await $(),V=await ee();D.value=g,y.value=V});function B(_){f.value=!0}function N(){f.value=!1,w(h.value)}const R=async()=>{try{await re.confirm("Are you sure you want to log out?","Warning",{type:"warning"}),await I.LOGIN_OUT(),await F.push("/login"),window.location.reload()}catch{}};function O(_){return y.value.find(g=>g.id===_)||null}async function w(_){try{const g=await te(_);a.value=g.data}catch{}}const S={t:P,route:e,router:F,userStore:I,roleOptions:D,departmentOptions:y,isFormProcessing:C,isUserFormDialogVisible:f,user:a,viewedUserId:h,handleEdit:B,handleUserSubmit:N,handleLogout:R,findDepartmentById:O,loadUser:w,onMounted:oe,ref:b,get useRoute(){return X},get useRouter(){return Z},get getAllDepartments(){return ee},get getAllRoles(){return $},get getUserById(){return te},get ElMessageBox(){return re},get Edit(){return ce},get Picture(){return de},get SwitchButton(){return ne},get useUserStore(){return ie},get useI18n(){return se},UserForm:ue};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},ge={class:"root"},ve={class:"left-container"},be={class:"profile-preview"},ye={class:"image-slot-circle"},he={class:"user-thumb"},xe={class:"user-name"},we={class:"user-text"},Ue={class:"actions-group"},ke={style:{flex:"1"}},Ie={class:"center-container"},De={class:"title-block",style:{"margin-top":"30px"}},Ce={class:"detail-section"},Be={style:{display:"flex","align-items":"center"}},Ne={style:{display:"flex","align-items":"center"}},Se={style:{display:"flex","align-items":"center"}},Ve={style:{display:"flex","align-items":"center"}},Fe={style:{display:"flex","align-items":"center"}},Re={style:{display:"flex","align-items":"center"}},Oe={style:{display:"flex","align-items":"center"}},Le={style:{display:"flex","align-items":"center"}},Pe={class:"title-block"},Ee={class:"detail-section"},ze={class:"role-card"},Ae={class:"title-block"},Me={class:"certificate-info-list"},Te={key:0},We={class:"image-container"},je={class:"cert-info detail-section"},qe={key:1};function Ge(le,c,P,e,F,I){var g,V,E,z,A,M,T,W,j,q,G,H,K,Q,Y,J;const D=m("el-icon"),y=m("el-image"),C=m("el-button"),f=m("el-text"),a=m("el-descriptions-item"),h=m("el-tag"),B=m("el-descriptions"),N=m("el-divider"),R=m("el-carousel-item"),O=m("el-carousel"),w=m("el-empty"),S=m("el-dialog"),_=_e("loading");return n(),u("div",ge,[c[3]||(c[3]=t("div",{class:"padding-container"},null,-1)),t("div",ve,[t("div",be,[p('              <WorkOrderImage :image-path="scope.row.image ? [scope.row.image] : null" />'),i(y,{src:((g=e.user)==null?void 0:g.image)!==null?(V=e.user)==null?void 0:V.image:"https://api.dicebear.com/7.x/initials/svg?seed="+encodeURIComponent(((E=e.user)==null?void 0:E.first_name)+" "+((z=e.user)==null?void 0:z.last_name)),fit:"cover","preview-src-list":[((A=e.user)==null?void 0:A.image)!==null?(M=e.user)==null?void 0:M.image:"https://api.dicebear.com/7.x/initials/svg?seed="+encodeURIComponent(((T=e.user)==null?void 0:T.first_name)+" "+((W=e.user)==null?void 0:W.last_name))],class:"circular-image","z-index":2e3,"preview-teleported":"",style:{width:"150px",height:"150px","border-radius":"50%"}},{error:s(()=>[t("div",ye,[i(D,null,{default:s(()=>[i(e.Picture)]),_:1})])]),_:1},8,["src","preview-src-list"]),t("div",he,[t("div",xe,r(((j=e.user)==null?void 0:j.first_name)+" "+((q=e.user)==null?void 0:q.last_name)),1),(n(!0),u(U,null,k((G=e.user)==null?void 0:G.roles,l=>(n(),u("div",{key:l.id,class:"user-text"},r(l.name||"-"),1))),128)),t("div",we,r(e.t("user.lastVisited"))+": "+r(((H=e.user)==null?void 0:H.last_visited)||"-"),1)])]),t("div",Ue,[t("div",ke,[i(C,{icon:e.Edit,type:"info",onClick:e.handleEdit},{default:s(()=>[d(r(e.t("common.edit")),1)]),_:1},8,["icon"])]),t("div",null,[i(C,{icon:e.SwitchButton,type:"danger",onClick:e.handleLogout},{default:s(()=>[d(r(e.t("userCenter.logout")),1)]),_:1},8,["icon"])])])]),t("div",Ie,[p(" Personal info title "),t("div",De,[i(f,{size:"large",tag:"b"},{default:s(()=>[d(r(e.t("user.userInformation")),1)]),_:1})]),p(" Personal Info Section "),t("div",Ce,[i(B,{class:"general-details-descriptions",column:4},{default:s(()=>{var l,v;return[i(a,{label:"ID",span:1},{default:s(()=>{var o;return[t("div",Be,[t("span",null,r((o=e.user)==null?void 0:o.id),1)])]}),_:1}),i(a,{label:e.t("user.firstName"),span:1},{default:s(()=>{var o;return[t("div",Ne,[t("span",null,r((o=e.user)==null?void 0:o.first_name),1)])]}),_:1},8,["label"]),i(a,{label:e.t("user.lastName"),span:1},{default:s(()=>{var o;return[t("div",Se,[t("span",null,r((o=e.user)==null?void 0:o.last_name),1)])]}),_:1},8,["label"]),i(a,{label:e.t("user.department"),span:1},{default:s(()=>[t("div",Ve,[i(f,null,{default:s(()=>{var o,x;return[d(r(((x=e.findDepartmentById((o=e.user)==null?void 0:o.department_id))==null?void 0:x.name)||"-"),1)]}),_:1})])]),_:1},8,["label"]),i(a,{label:e.t("user.table.username"),span:1},{default:s(()=>{var o;return[t("div",Fe,[t("span",null,r((o=e.user)==null?void 0:o.username),1)])]}),_:1},8,["label"]),i(a,{label:e.t("user.table.phoneNumber"),span:1},{default:s(()=>{var o;return[t("div",Re,[t("span",null,r((o=e.user)==null?void 0:o.phone_number),1)])]}),_:1},8,["label"]),i(a,{label:e.t("user.table.email"),span:1},{default:s(()=>{var o;return[t("div",Oe,[t("span",null,r((o=e.user)==null?void 0:o.email),1)])]}),_:1},8,["label"]),((v=(l=e.user)==null?void 0:l.teams)==null?void 0:v.length)>0?(n(),L(a,{key:0,label:e.t("user.assignedTeam"),span:2},{default:s(()=>{var o;return[t("div",Le,[(n(!0),u(U,null,k((o=e.user)==null?void 0:o.teams,(x,ae)=>(n(),L(h,{key:ae,type:x.isLeader===!0?"warning":"info"},{default:s(()=>[d(r(x.name)+" - "+r(x.isLeader?"Leader":"Member"),1)]),_:2},1032,["type"]))),128))])]}),_:1},8,["label"])):p("v-if",!0)]}),_:1})]),i(N),p(" Role title "),t("div",Pe,[i(f,{size:"large",tag:"b"},{default:s(()=>[d(r(e.t("user.table.role")),1)]),_:1})]),p(" Role cards "),t("div",Ee,[(n(!0),u(U,null,k(((K=e.user)==null?void 0:K.roles)||[],l=>(n(),u("div",{key:l.id,class:"el-col el-col-24 is-guttered card-container"},[t("div",ze,[i(f,{size:"large",style:{color:"var(--el-color-primary)"}},{default:s(()=>[d(r(l.name),1)]),_:2},1024),p(" Hide permission matrix table for now "),p('            <role-permission-content :role="role" />')])]))),128))]),i(N),p(" Certificates title "),t("div",Ae,[i(f,{size:"large",tag:"b"},{default:s(()=>[d(r(e.t("user.certificate")),1)]),_:1})]),p(" Certificate cards "),t("div",Me,[((Y=(Q=e.user)==null?void 0:Q.certificates)==null?void 0:Y.length)>0?(n(),u("div",Te,[(n(!0),u(U,null,k(((J=e.user)==null?void 0:J.certificates)||[],l=>(n(),u("div",{key:l.id,class:"info-card",style:{display:"flex","flex-direction":"row",gap:"16px"}},[t("div",We,[i(O,{height:"150px"},{default:s(()=>[(n(!0),u(U,null,k(l.image_list,v=>(n(),L(R,{key:v.id},{default:s(()=>[i(y,{src:v.url,fit:"contain",style:{height:"150px",width:"150px"}},null,8,["src"])]),_:2},1024))),128))]),_:2},1024)]),t("div",je,[i(B,{class:"general-details-descriptions",column:4},{default:s(()=>[i(a,{label:e.t("user.certificateName")},{default:s(()=>[d(r(l.certificate_name),1)]),_:2},1032,["label"]),i(a,{label:e.t("user.certificateNumber")},{default:s(()=>[d(r(l.certificate_number),1)]),_:2},1032,["label"]),i(a,{label:e.t("user.issueDate")},{default:s(()=>[d(r(l.issue_date.slice(0,10)),1)]),_:2},1032,["label"]),i(a,{label:e.t("user.expiryDate")},{default:s(()=>[d(r(l.expiration_date.slice(0,10)),1)]),_:2},1032,["label"]),i(a,{label:e.t("user.reviewer")},{default:s(()=>{var v;return[d(r((v=l.reviewer)==null?void 0:v.name),1)]}),_:2},1032,["label"])]),_:2},1024)])]))),128))])):(n(),u("div",qe,[i(w,{description:e.t("user.noCertificates"),"image-size":120,style:{"margin-top":"12px"}},null,8,["description"])]))])]),c[4]||(c[4]=t("div",{class:"padding-container"},null,-1)),i(S,{title:e.t("user.form.editUser"),modelValue:e.isUserFormDialogVisible,"onUpdate:modelValue":c[2]||(c[2]=l=>e.isUserFormDialogVisible=l),top:"10vh",width:"50%"},{default:s(()=>[pe((n(),u("div",null,[i(e.UserForm,{user:e.user,"role-options":e.roleOptions,"department-options":e.departmentOptions,onConfirm:e.handleUserSubmit,onCancel:c[0]||(c[0]=()=>e.isUserFormDialogVisible=!1),"onUpdate:loading":c[1]||(c[1]=l=>e.isFormProcessing=l)},null,8,["user","role-options","department-options"])])),[[_,e.isFormProcessing]])]),_:1},8,["title","modelValue"])])}const St=me(fe,[["render",Ge],["__scopeId","data-v-06a6abc8"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/user/components/UserDetail.vue"]]);export{St as default};
