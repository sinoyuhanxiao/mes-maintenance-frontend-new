import"../vue/vue.Dfo81L2Q.js";import{u as F}from"../vue-i18n/vue-i18n.DjO1PVT4.js";import{L as Ee}from"../index/index.BtHzJbLx.js";import{M as xe,an as Ce,V as Le}from"../@element-plus/@element-plus.BNeHluFm.js";import{h as W,E as Fe,_ as J}from"../../assets/index-CE-d1vf_.js";import{a as ne,b as oe}from"../user/user.DvQSuXH1.js";import{a as ie,s as re}from"../location/location.DF4AJa93.js";import{g as ve,c as Q,E as L}from"../element-plus/element-plus.CU5xiOkY.js";import{K as C,o as d,r as h,q as A,j as B,am as w,c as y,S as a,a as V,L as n,F as O,a8 as z,Q as k,R as g,w as K,t as se,O as N,as as Ue,_ as de,M as me}from"../@vue/@vue.CVGyaoMH.js";import{d as ce,s as ue}from"../equipment/equipment.hEuZPeX-.js";import{U as Oe}from"../UserTag/UserTag.cokAVoqN.js";import"../@intlify/@intlify.BhOIvmlS.js";import"../index/index.6be3zOyE.js";import"../pinia/pinia.CzPcBe5J.js";import"../vue-demi/vue-demi.-dVQ4Px2.js";import"../js-cookie/js-cookie.Cz0CWeBA.js";import"../geotiff/geotiff.Dp1pzeXC.js";import"../vue-router/vue-router.30cuaQZO.js";import"../path-to-regexp/path-to-regexp.i8-bKtXe.js";import"../fuse.js/fuse.js.BiDyM4rQ.js";import"../path-browserify/path-browserify.DkEToxTs.js";import"../screenfull/screenfull.DmVOzVZz.js";import"../mitt/mitt.DJ65BbbF.js";import"../lodash-es/lodash-es.BLHqGvLj.js";import"../@vueuse/@vueuse.B5lT-MN9.js";import"../axios/axios.Dq7h7Pqt.js";import"../nprogress/nprogress._Z8YfKSV.js";/* empty css                                 */import"../clipboard/clipboard.DAe4Lk7l.js";import"../vue3-lottie/vue3-lottie.DS19j_I8.js";import"../lottie-web/lottie-web.fKmgUVyQ.js";import"../@popperjs/@popperjs.D_chPuIy.js";import"../@ctrl/@ctrl.r5W6hzzQ.js";import"../dayjs/dayjs.C0sY0_St.js";import"../async-validator/async-validator.D3FX-SGt.js";import"../memoize-one/memoize-one.BdPwpGay.js";import"../normalize-wheel-es/normalize-wheel-es.BQoi3Ox2.js";import"../@floating-ui/@floating-ui.85_40PfK.js";const X=Fe.USER_CLIENT_URL,_e=(T={},t=1,l=10,e="createdAt",_="DESC")=>W.request({method:"post",url:"/team/search",baseURL:X,data:T,params:{page:t,size:l,sortField:e,direction:_}}),pe=T=>W.request({method:"post",url:"/team",baseURL:X,data:T}),fe=(T,t)=>W.request({method:"patch",url:`/team/${T}`,baseURL:X,data:t}),ge=T=>W.request({method:"post",url:`/team/${T}/deactivate`,baseURL:X}),De={__name:"LocationTreeSelect",emits:["update:modelValue","change"],setup(T,{expose:t,emit:l}){t();const{t:e}=F(),_=h([]),q=h([]),b={label:c=>c.name,children:"children",value:"id"},m=l;async function f(){try{const c=await ie();q.value=c.data||[]}catch(c){console.error("Failed to fetch location tree:",c)}}function r(){const c=Array.isArray(_.value)?_.value:[_.value];m("update:modelValue",c),m("change",c)}A(async()=>{await f()});const p={t:e,selectedLocationIds:_,locationTree:q,locationNodeDefaultProps:b,emit:m,fetchLocationTree:f,emitSelection:r,ref:h,onMounted:A,get getLocationTree(){return ie},get ElTreeSelect(){return ve},get useI18n(){return F}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}};function Me(T,t,l,e,_,q){return d(),C(e.ElTreeSelect,{modelValue:e.selectedLocationIds,"onUpdate:modelValue":t[0]||(t[0]=b=>e.selectedLocationIds=b),data:e.locationTree,props:e.locationNodeDefaultProps,multiple:"","check-strictly":"","show-checkbox":"","node-key":"id","default-expand-all":!1,filterable:!0,placeholder:e.t("team.placeholder.selectLocation"),style:{width:"100%"},clearable:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,onChange:e.emitSelection},null,8,["modelValue","data","placeholder"])}const he=J(De,[["render",Me],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/components/LocationTreeSelect.vue"]]),Ie={__name:"EquipmentTreeSelect",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(T,{expose:t,emit:l}){t();const{t:e}=F(),_=h([]),q=T,b=B({get:()=>q.modelValue,set:p=>f("update:modelValue",p)}),m={label:p=>p.code?`${p.name} (${p.code})`:p.name,value:"id",children:"children"};A(async()=>{try{const p=await ce();_.value=p.data||[]}catch(p){console.error("Failed to fetch equipment tree:",p)}});const f=l,r={t:e,treeData:_,props:q,selectedIds:b,defaultProps:m,emit:f,ref:h,onMounted:A,computed:B,get ElTreeSelect(){return ve},get getEquipmentTree(){return ce},get useI18n(){return F}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}};function Pe(T,t,l,e,_,q){return d(),C(e.ElTreeSelect,{modelValue:e.selectedIds,"onUpdate:modelValue":t[0]||(t[0]=b=>e.selectedIds=b),data:e.treeData,props:e.defaultProps,multiple:"","check-strictly":"","show-checkbox":"","node-key":"id","default-expand-all":!1,filterable:!0,"render-after-expand":!1,placeholder:e.t("team.placeholder.selectEquipment"),style:{width:"100%"},clearable:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2},null,8,["modelValue","data","placeholder"])}const be=J(Ie,[["render",Pe],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/components/EquipmentTreeSelect.vue"]]),Re={__name:"TeamForm",props:{team:{type:Object,default:null},departmentOptions:{type:Array,default:()=>[]},userOptions:{type:Array,default:()=>[]}},emits:["confirm","cancel","update:loading"],setup(T,{expose:t,emit:l}){t();const e=T,{t:_}=F(),q=l,b={name:[{required:!0,message:_("team.validation.nameRequired"),trigger:"blur"}],code:[{required:!0,message:_("team.validation.codeRequired"),trigger:"blur"}]},m=h(),f=h(!1),r=h(p());function p(){return{id:null,name:"",code:"",description:"",department_id:null,leader_id:null,member_requests:[],location_ids:[],equipment_node_ids:[],team_members_id:[]}}function c(i){return{...p(),...i,location_ids:i.team_locations_id,equipment_node_ids:i.team_equipment_nodes_id}}const o=h(null);K(()=>e.team,async i=>{if(i){const S=c(i);r.value=S,o.value=JSON.parse(JSON.stringify(S))}else r.value=p(),o.value=null;await se(),m.value&&m.value.clearValidate()},{immediate:!0}),K(()=>r.value.leader_id,(i,S)=>{if(!i)return;const E=r.value.team_members_id.indexOf(i);E!==-1&&r.value.team_members_id.splice(E,1)});async function R(){try{await Q.confirm(_("common.confirmMessage",_("common.warning"),{type:"warning",confirmButtonText:_("common.confirm"),cancelButtonText:_("common.cancel"),distinguishCancelAndClose:!0})),o.value===null?r.value=p():r.value=JSON.parse(JSON.stringify(o.value)),m.value.clearValidate()}catch{}}const M=i=>({name:i.name,code:i.code,description:i.description,department_id:i.department_id,member_requests:i.member_requests,team_location_ids:i.location_ids,team_equipment_node_ids:i.equipment_node_ids}),D=(i,S)=>{const E={};return i.name!==S.name&&(E.name=i.name),i.code!==S.code&&(E.code=i.code),i.description!==S.description&&(E.description=i.description),i.department_id!==S.department_id&&(E.department_id=i.department_id),i.member_requests!==S.member_requests&&(E.member_requests=i.member_requests),i.location_ids!==S.location_ids&&(E.team_locations_id=i.location_ids),i.equipment_node_ids!==S.equipment_node_ids&&(E.team_equipment_nodes_id=i.equipment_node_ids),E},s=B(()=>{if(!r.value.id||!o.value)return!0;const i=D(r.value,o.value);return Object.keys(i).length>0});async function x(){if(!await m.value.validate())return L.error(_("user.message.pleaseCorrectErrors"));f.value=!0,q("update:loading",!0);try{r.value.member_requests=j(r.value.leader_id,r.value.team_members_id);const S=r.value.id?D(r.value,o.value):M(r.value);r.value.id?(await fe(r.value.id,S),L.success(_("team.message.updated"))):(await pe(S),L.success(_("team.message.created"))),q("confirm")}catch(S){console.error("Error submitting team form:",S),L.error(_("team.message.teamUpdatedFailed"))}finally{f.value=!1,q("update:loading",!1)}}function j(i,S){const E=[];i&&E.push({userId:i,isLeader:!0});for(const G of S)G!==i&&E.push({userId:G,isLeader:!1});return E}const I={prop:e,t:_,emit:q,teamFormRules:b,formRef:m,submitting:f,internalTeam:r,createEmptyTeam:p,transformIncomingTeam:c,originalTeamSnapshot:o,handleResetForm:R,buildCreateTeamPayload:M,buildUpdateTeamPayload:D,isTeamEdited:s,handleConfirmSubmit:x,buildMemberRequests:j,EquipmentTreeSelect:be,LocationTreeSelect:he,get createTeam(){return pe},get updateTeam(){return fe},get ElMessage(){return L},get ElMessageBox(){return Q},computed:B,nextTick:se,ref:h,watch:K,get useI18n(){return F}};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},ze={class:"form-row"},Ne={class:"form-row"},je={class:"form-row"},Ae={class:"form-row"},Be={class:"form-row"},Je={class:"form-action-row"};function He(T,t,l,e,_,q){const b=w("el-input"),m=w("el-form-item"),f=w("el-option"),r=w("el-select"),p=w("el-form"),c=w("el-button");return d(),y(O,null,[a(p,{ref:"formRef",model:e.internalTeam,rules:e.teamFormRules,"label-width":"160px",class:"two-col-form"},{default:n(()=>[V("div",ze,[a(m,{prop:"name",label:e.t("team.name")},{default:n(()=>[a(b,{modelValue:e.internalTeam.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.internalTeam.name=o)},null,8,["modelValue"])]),_:1},8,["label"]),a(m,{prop:"code",label:e.t("team.code")},{default:n(()=>[a(b,{modelValue:e.internalTeam.code,"onUpdate:modelValue":t[1]||(t[1]=o=>e.internalTeam.code=o)},null,8,["modelValue"])]),_:1},8,["label"])]),V("div",Ne,[a(m,{class:"full-width",prop:"description",label:e.t("common.description")},{default:n(()=>[a(b,{type:"textarea",modelValue:e.internalTeam.description,"onUpdate:modelValue":t[2]||(t[2]=o=>e.internalTeam.description=o)},null,8,["modelValue"])]),_:1},8,["label"])]),V("div",je,[a(m,{prop:"leader_id",label:e.t("team.leader")},{default:n(()=>[a(r,{modelValue:e.internalTeam.leader_id,"onUpdate:modelValue":t[3]||(t[3]=o=>e.internalTeam.leader_id=o),placeholder:e.t("team.placeholder.selectLeader"),clearable:"",filterable:""},{default:n(()=>[(d(!0),y(O,null,z(l.userOptions,o=>(d(),C(f,{key:o.id,label:o.first_name+" "+o.last_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,{prop:"team_members_id",label:e.t("team.members")},{default:n(()=>[a(r,{modelValue:e.internalTeam.team_members_id,"onUpdate:modelValue":t[4]||(t[4]=o=>e.internalTeam.team_members_id=o),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,filterable:"",placeholder:e.t("team.placeholder.selectMembers")},{default:n(()=>[(d(!0),y(O,null,z(l.userOptions,o=>(d(),C(f,{key:o.id,label:o.first_name+" "+o.last_name,value:o.id,disabled:o.id===e.internalTeam.leader_id},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),V("div",Ae,[a(m,{prop:"department_id",label:e.t("user.department")},{default:n(()=>[a(r,{modelValue:e.internalTeam.department_id,"onUpdate:modelValue":t[5]||(t[5]=o=>e.internalTeam.department_id=o),clearable:""},{default:n(()=>[(d(!0),y(O,null,z(l.departmentOptions,o=>(d(),C(f,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(m,{prop:"location_ids",label:e.t("team.assignedLocation")},{default:n(()=>[a(e.LocationTreeSelect,{modelValue:e.internalTeam.location_ids,"onUpdate:modelValue":t[6]||(t[6]=o=>e.internalTeam.location_ids=o)},null,8,["modelValue"])]),_:1},8,["label"])]),V("div",Be,[a(m,{prop:"equipment_node_ids",label:e.t("team.assignedEquipment")},{default:n(()=>[a(e.EquipmentTreeSelect,{modelValue:e.internalTeam.equipment_node_ids,"onUpdate:modelValue":t[7]||(t[7]=o=>e.internalTeam.equipment_node_ids=o)},null,8,["modelValue"])]),_:1},8,["label"])])]),_:1},8,["model"]),V("div",Je,[a(c,{onClick:t[8]||(t[8]=o=>e.emit("cancel"))},{default:n(()=>[k(g(e.t("common.cancel")),1)]),_:1}),a(c,{type:"warning",onClick:e.handleResetForm},{default:n(()=>[k(g(e.t("workOrder.actions.reset")),1)]),_:1}),a(c,{type:"primary",disabled:e.internalTeam.id&&!e.isTeamEdited,onClick:e.handleConfirmSubmit},{default:n(()=>[k(g(e.t("common.confirm")),1)]),_:1},8,["disabled"])])],64)}const Ke=J(Re,[["render",He],["__scopeId","data-v-59179dee"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/components/TeamForm.vue"]]),Ge={__name:"LocationTag",props:{location:{type:Object,default:null}},setup(T,{expose:t}){t();const{t:l}=F(),e={t:l,get useI18n(){return F}};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}},Qe={key:0},We={key:0},Xe={key:1};function Ye(T,t,l,e,_,q){const b=w("el-tag"),m=w("el-text"),f=w("el-image"),r=w("el-popover");return d(),y(O,null,[N(" Unknown location "),l.location?(d(),C(r,{key:1,effect:"light",trigger:"hover",placement:"top",width:"auto"},{default:n(()=>{var p;return[V("div",null,[a(m,null,{default:n(()=>[k(g("ID")+": "+g(l.location.id),1)]),_:1})]),V("div",null,[a(m,null,{default:n(()=>[k(g(e.t("common.name"))+": "+g(l.location.name),1)]),_:1})]),V("div",null,[a(m,null,{default:n(()=>[k(g(e.t("common.code"))+": "+g(l.location.code),1)]),_:1})]),l.location.location_type?(d(),y("div",We,[a(m,null,{default:n(()=>{var c;return[k(g(e.t("common.type"))+": "+g((c=l.location.location_type)==null?void 0:c.name),1)]}),_:1})])):N("v-if",!0),((p=l.location.image_list)==null?void 0:p.length)>0?(d(),y("div",Xe,[a(f,{src:l.location.image_list[0],fit:"cover","preview-src-list":l.location.image_list,class:"location-image-preview","z-index":2e3,"preview-teleported":""},null,8,["src","preview-src-list"])])):N("v-if",!0)]}),reference:n(()=>[a(b,{type:"primary",size:"small",effect:"light"},{default:n(()=>[k(g(l.location.name),1)]),_:1})]),_:1})):(d(),y("span",Qe,[a(b,{size:"small",type:"info",effect:"light"},{default:n(()=>[k(g(e.t("location.unknownLocation")),1)]),_:1})]))],2112)}const Ze=J(Ge,[["render",Ye],["__scopeId","data-v-461f5a3c"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/components/LocationTag.vue"]]),$e={__name:"EquipmentTag",props:{equipment:{type:Object,default:null}},setup(T,{expose:t}){t();const{t:l}=F(),e={t:l,get useI18n(){return F}};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}},et={key:0},tt={key:0};function at(T,t,l,e,_,q){const b=w("el-tag"),m=w("el-text"),f=w("el-popover");return d(),y(O,null,[N(" Unknown equipment "),l.equipment?(d(),C(f,{key:1,effect:"light",trigger:"hover",placement:"top",width:"auto"},{default:n(()=>[V("div",null,[a(m,null,{default:n(()=>[k(g("ID")+": "+g(l.equipment.id),1)]),_:1})]),V("div",null,[a(m,null,{default:n(()=>[k(g(e.t("common.name"))+": "+g(l.equipment.name),1)]),_:1})]),V("div",null,[a(m,null,{default:n(()=>[k(g(e.t("common.code"))+": "+g(l.equipment.code),1)]),_:1})]),l.equipment.node_type?(d(),y("div",tt,[a(m,null,{default:n(()=>{var r;return[k(g(e.t("common.type"))+": "+g((r=l.equipment.node_type)==null?void 0:r.default_label),1)]}),_:1})])):N("v-if",!0)]),reference:n(()=>[a(b,{type:"primary",size:"small",effect:"light"},{default:n(()=>[k(g(l.equipment.name),1)]),_:1})]),_:1})):(d(),y("span",et,[a(b,{size:"small",type:"info",effect:"light"},{default:n(()=>[k(g(e.t("equipment.unknownEquipment")),1)]),_:1})]))],2112)}const lt=J($e,[["render",at],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/components/EquipmentTag.vue"]]),nt={__name:"index",setup(T,{expose:t}){t();const{t:l}=F(),e=h(!1),_=h(!1),q=h(!1),b=h([]),m=h({prop:"",order:""}),f=h(1),r=h(20),p=h(0),c=h(0),o=h(window.innerHeight-250),R=h([]),M=h({}),D=h({}),s=h([]),x=h(null),j={keyword:"",department_ids:[],location_ids:[],equipment_node_ids:[]},I=de({...j}),i=B(()=>Object.fromEntries(R.value.map(v=>[v.id,v])));function S(){x.value=null,q.value=!0}function E(v){x.value=v,q.value=!0}function G(){q.value=!1,P()}function Y(){try{f.value=1,P()}catch{L.error(l("team.message.teamFetchFailed"))}}function ye(){Object.assign(I,j),Y()}function we(v){f.value=v,P()}function Te(v){r.value=v,f.value=1,P()}function qe({prop:v,order:u}){m.value={prop:v,order:u},P()}async function P(){function v(u){return u.replace(/_([a-z])/g,(H,U)=>U.toUpperCase())}e.value=!0;try{const u=v(m.value.prop),U=(await _e(I,f.value,r.value,u,m.value.order==="ascending"?"ASC":"DESC")).data,ke=U.content||[];b.value=ke.map(Z=>({...Z,team_locations_id:(Z.team_locations_id||[]).filter($=>M.value[String($)]!==void 0),team_equipment_nodes_id:(Z.team_equipment_nodes_id||[]).filter($=>D.value[String($)]!==void 0)})),c.value=U.totalPages,p.value=U.totalElements}catch(u){console.error("Failed to load teams:",u),L.error(l("team.message.fetchFailed"))}finally{e.value=!1}}async function Ve(v){try{await Q.confirm(l("common.confirmMessage"),l("common.warning"),{confirmButtonText:l("common.confirm"),cancelButtonText:l("common.cancel"),type:"warning",distinguishCancelAndClose:!0}),await ge(v),await P(),L.success(l("teamDeletedSuccess"))}catch(u){if(u==="cancel"||u==="close")return;console.error(u),L.error(l("teamDeletedFailed"))}}async function ee(){var v;try{const u=await oe(1,1e3);R.value=((v=u==null?void 0:u.data)==null?void 0:v.content)||[]}catch(u){console.error("Failed to load users:",u),L.error(l("user.message.errorLoadingUsersData"))}}async function te(){var v;try{const u=await re({status_ids:[1]},1,1e3),H=((v=u==null?void 0:u.data)==null?void 0:v.content)||[];M.value=Object.fromEntries(H.map(U=>[String(U.id),U]))}catch(u){console.error("Failed to load users:",u),L.error(l("user.message.errorLoadingUsersData"))}}async function ae(){var v;try{const u=await ue({status_ids:[1]},1,1e3),H=((v=u==null?void 0:u.data)==null?void 0:v.content)||[];D.value=Object.fromEntries(H.map(U=>[String(U.id),{...U}]))}catch(u){console.error("Failed to load equipments:",u),L.error(l("common.message.errorLoadingEquipmentData"))}}function Se(v){return(v||[]).map(u=>i.value[u]).filter(Boolean)}K(()=>[I.location_ids,I.equipment_node_ids],()=>{Y()},{deep:!0}),A(async()=>{s.value=await ne(),await te(),await ae(),await ee(),await P()});const le={t:l,loading:e,isFormProcessing:_,isDialogVisible:q,teamsTableData:b,sortSettings:m,currentPage:f,pageSize:r,totalElements:p,totalPages:c,tableHeight:o,userOptions:R,locationMap:M,equipmentMap:D,departmentOptions:s,currentEditingTeam:x,initialFilters:j,localFilters:I,userMap:i,openCreateForm:S,handleEdit:E,handleTeamSubmitted:G,handleFilterChange:Y,clearLocalFilters:ye,handlePageChange:we,handleSizeChange:Te,handleSortChange:qe,loadTeams:P,handleDelete:Ve,loadUsers:ee,loadLocations:te,loadEquipments:ae,getValidMembers:Se,ref:h,reactive:de,onMounted:A,watch:K,computed:B,get useI18n(){return F},get MesLayout(){return Ee},get EditPen(){return Le},get Remove(){return Ce},get Search(){return xe},get searchTeams(){return _e},get deactivateTeam(){return ge},get getAllDepartments(){return ne},get getAllUsers(){return oe},get ElMessage(){return L},get ElMessageBox(){return Q},LocationTreeSelect:he,EquipmentTreeSelect:be,TeamForm:Ke,UserTag:Oe,get searchLocations(){return re},get searchEquipmentNodes(){return ue},LocationTag:Ze,EquipmentTag:lt};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}},ot={class:"toolbar"},it={class:"filters-container"},rt={class:"filter-item"},st={class:"filter-item"},dt={class:"filter-item"},mt={class:"filter-item"},ct={class:"actions-row"},ut={class:"actions-item"},_t={class:"actions-item"},pt={key:1},ft={key:0,class:"tag-list"},gt={key:1},vt={key:0,class:"tag-list"},ht={key:1},bt={key:0,class:"tag-list"},yt={key:1};function wt(T,t,l,e,_,q){const b=w("el-option"),m=w("el-select"),f=w("el-button"),r=w("el-icon"),p=w("el-input"),c=w("el-table-column"),o=w("el-table"),R=w("el-dialog"),M=w("el-pagination"),D=Ue("loading");return d(),C(e.MesLayout,{title:e.t("router.teamManagement"),"view-mode":"table"},{viewMode:n(()=>t[7]||(t[7]=[])),head:n(()=>[N(" User local filters "),V("div",ot,[V("div",it,[V("div",rt,[a(m,{modelValue:e.localFilters.department_ids,"onUpdate:modelValue":t[0]||(t[0]=s=>e.localFilters.department_ids=s),placeholder:e.t("user.department"),clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",size:"default",style:{width:"200px"},onChange:e.handleFilterChange},{default:n(()=>[(d(!0),y(O,null,z(e.departmentOptions,s=>(d(),C(b,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),V("div",st,[a(e.LocationTreeSelect,{modelValue:e.localFilters.location_ids,"onUpdate:modelValue":t[1]||(t[1]=s=>e.localFilters.location_ids=s)},null,8,["modelValue"])]),V("div",dt,[a(e.EquipmentTreeSelect,{modelValue:e.localFilters.equipment_node_ids,"onUpdate:modelValue":t[2]||(t[2]=s=>e.localFilters.equipment_node_ids=s)},null,8,["modelValue"])]),V("div",mt,[a(f,{icon:e.Remove,type:"warning",plain:"",onClick:e.clearLocalFilters},{default:n(()=>[k(g(e.t("workOrder.filters.clearAll")),1)]),_:1},8,["icon"])])]),V("div",ct,[V("div",ut,[a(p,{modelValue:e.localFilters.keyword,"onUpdate:modelValue":t[3]||(t[3]=s=>e.localFilters.keyword=s),placeholder:e.t("user.searchByName"),clearable:"",onInput:e.handleFilterChange,style:{width:"200px"}},{prefix:n(()=>[a(r,null,{default:n(()=>[a(e.Search)]),_:1})]),_:1},8,["modelValue","placeholder"])]),V("div",_t,[a(f,{icon:e.EditPen,type:"primary",onClick:e.openCreateForm},{default:n(()=>[k(g(e.t("workOrder.actions.create")),1)]),_:1},8,["icon"])])])])]),body:n(()=>[me((d(),C(o,{data:e.teamsTableData,style:{width:"100%"},border:"",fit:"","highlight-current-row":"",height:e.tableHeight,"empty-text":e.t("common.noData"),onSortChange:e.handleSortChange},{default:n(()=>[a(c,{prop:"id",label:"ID",width:"100",sortable:"custom",align:"center",fixed:"left"}),a(c,{prop:"name",label:e.t("team.name"),width:"220",sortable:"custom",align:"center",fixed:"left"},null,8,["label"]),a(c,{prop:"leader_id",label:e.t("team.leader"),width:"150",align:"center"},{default:n(s=>[s.row.leader_id?(d(),y(O,{key:0},[e.userMap[s.row.leader_id]?(d(),C(e.UserTag,{key:0,user:e.userMap[s.row.leader_id],style:{margin:"2px"}},null,8,["user"])):N("v-if",!0)],64)):(d(),y("span",pt,"-"))]),_:1},8,["label"]),a(c,{prop:"team_members_id",label:e.t("team.members"),align:"center",width:"260"},{default:n(s=>[e.getValidMembers(s.row.team_members_id).length?(d(),y("div",ft,[(d(!0),y(O,null,z(e.getValidMembers(s.row.team_members_id),x=>(d(),C(e.UserTag,{key:x.id,user:x},null,8,["user"]))),128))])):(d(),y("span",gt,"-"))]),_:1},8,["label"]),a(c,{prop:"team_locations_id",label:e.t("team.assignedLocation"),align:"center",width:"260"},{default:n(s=>[s.row.team_locations_id&&s.row.team_locations_id.length?(d(),y("div",vt,[(d(!0),y(O,null,z(s.row.team_locations_id,x=>(d(),C(e.LocationTag,{key:x,location:e.locationMap[String(x)]||null},null,8,["location"]))),128))])):(d(),y("span",ht,"-"))]),_:1},8,["label"]),a(c,{prop:"team_equipment_nodes_id",label:e.t("team.assignedEquipment"),align:"center",width:"260"},{default:n(s=>[s.row.team_equipment_nodes_id&&s.row.team_equipment_nodes_id.length?(d(),y("div",bt,[(d(!0),y(O,null,z(s.row.team_equipment_nodes_id,x=>(d(),C(e.EquipmentTag,{key:x,equipment:e.equipmentMap[String(x)]||null},null,8,["equipment"]))),128))])):(d(),y("span",yt,"-"))]),_:1},8,["label"]),a(c,{prop:"code",label:e.t("team.code"),width:"150",sortable:"custom",align:"center"},null,8,["label"]),a(c,{prop:"description",label:e.t("common.description"),width:"400",sortable:"custom",align:"center"},null,8,["label"]),a(c,{label:e.t("common.actions"),fixed:"right",align:"center","header-align":"center",width:"160"},{default:n(s=>[a(f,{size:"small",onClick:x=>e.handleEdit(s.row)},{default:n(()=>[k(g(e.t("common.edit")),1)]),_:2},1032,["onClick"]),a(f,{size:"small",type:"danger",onClick:x=>e.handleDelete(s.row.id)},{default:n(()=>[k(g(e.t("common.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","height","empty-text"])),[[D,e.loading]]),a(R,{title:e.currentEditingTeam?e.t("team.editTeam"):e.t("team.newTeam"),modelValue:e.isDialogVisible,"onUpdate:modelValue":t[6]||(t[6]=s=>e.isDialogVisible=s),top:"10vh",width:"50%"},{default:n(()=>[me((d(),y("div",null,[a(e.TeamForm,{team:e.currentEditingTeam,"department-options":e.departmentOptions,"user-options":e.userOptions,onConfirm:e.handleTeamSubmitted,onCancel:t[4]||(t[4]=()=>e.isDialogVisible=!1),"onUpdate:loading":t[5]||(t[5]=s=>e.isFormProcessing=s)},null,8,["team","department-options","user-options"])])),[[D,e.isFormProcessing]])]),_:1},8,["title","modelValue"])]),foot:n(()=>[a(M,{onCurrentChange:e.handlePageChange,onSizeChange:e.handleSizeChange,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",total:e.totalElements},null,8,["current-page","page-size","total"])]),_:1},8,["title"])}const ia=J(nt,[["render",wt],["__scopeId","data-v-ce6a1096"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/team/index.vue"]]);export{ia as default};
