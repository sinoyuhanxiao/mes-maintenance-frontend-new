import{d as J}from"../pinia/pinia.CzPcBe5J.js";import{e as ie,f as ne,h as re,a as ae,s as oe,i as le,j as de,k as ce,l as ue}from"../task-library/task-library.-tD9DWhJ.js";import"../vue/vue.Dfo81L2Q.js";import{f as z,E as A}from"../element-plus/element-plus.CU5xiOkY.js";import{j as P,am as S,c as y,o as f,a as m,O as v,Q as w,R as g,S as p,L as T,F as pe,a8 as _e,G as K,K as W,r as C,w as F}from"../@vue/@vue.CVGyaoMH.js";import{a as G,j as Z,i as R,aq as me,aa as fe,ar as ye,af as he}from"../@element-plus/@element-plus.BNeHluFm.js";import{_ as q}from"../../assets/index-CE-d1vf_.js";const ge=J("taskLibrary",{state:()=>({templates:[],currentTemplate:null,loading:!1,templateDetailLoading:!1,filters:{keyword:"",equipment_node_ids:[],category:"",search:"",asset:[],reference_id:""},pagination:{page:1,size:20,total:0,sortField:"createdAt",direction:"DESC"},templateUpdateListeners:[]}),getters:{filteredTemplates:e=>Array.isArray(e.templates)?e.templates:[],templateCategories:e=>Array.isArray(e.templates)?[...new Set(e.templates.map(t=>t.category))].filter(Boolean):[],publishedTemplates:e=>Array.isArray(e.templates)?e.templates.filter(s=>s.status==="published"):[],draftTemplates:e=>Array.isArray(e.templates)?e.templates.filter(s=>s.status==="draft"):[]},actions:{async fetchTemplates(e={}){this.loading=!0;try{const s={},t=this.filters.keyword||this.filters.search||"";t.trim()&&(s.keyword=t.trim());const i=this.filters.reference_id||"";i.trim()&&(s.reference_id=i.trim());const n=this.filters.equipment_node_ids.length>0?this.filters.equipment_node_ids:this.filters.asset||[];Array.isArray(n)&&n.length>0&&(s.equipment_node_ids=n),e.reference_id&&(s.reference_id=e.reference_id),e.step_ids&&Array.isArray(e.step_ids)&&e.step_ids.length>0&&(s.step_ids=e.step_ids);const l=await oe(this.pagination.page,this.pagination.size,this.pagination.sortField,this.pagination.direction,s),r=l.data.content||[];this.templates=Array.isArray(r)?r.map(this.transformApiTemplate):[],this.pagination.total=l.data.totalElements||0}catch(s){throw console.error("Failed to fetch templates:",s),this.templates=[],this.pagination.total=0,s}finally{this.loading=!1}},async fetchTemplate(e){this.templateDetailLoading=!0;try{const s=await ae(e);return this.currentTemplate=s.data,s.data}catch(s){throw console.error("Failed to fetch template:",s),s}finally{this.templateDetailLoading=!1}},async createNewTemplate(e){this.loading=!0;try{const t=(await re(e)).data,i=this.transformApiTemplate(t);return this.templates.unshift(i),this.currentTemplate=i,i}catch(s){throw console.error("Failed to create template:",s),s}finally{this.loading=!1}},async updateCurrentTemplate(e){if(this.currentTemplate)return await this.updateTemplateById(this.currentTemplate.template_id||this.currentTemplate.id,e)},async updateTemplateById(e,s){this.loading=!0;try{let t=null;if(this.currentTemplate&&(this.currentTemplate.template_id===e||this.currentTemplate.id===e))t=this.currentTemplate;else{const u=this.templates.find(_=>_.template_id===e||_.id===e);if(u)t=u;else try{t=await this.fetchTemplate(e)}catch(_){console.warn("Failed to fetch original template:",_)}}const n=(await ne(e,s,t)).data,l=this.transformApiTemplate(n),r=this.templates.findIndex(u=>u.template_id===e||u.id===e);return r!==-1&&(this.templates[r]=l),this.currentTemplate&&(this.currentTemplate.template_id===e||this.currentTemplate.id===e)&&(this.currentTemplate=l),this.emitTemplateUpdate(l),l}catch(t){throw console.error("Failed to update template:",t),t}finally{this.loading=!1}},async deleteTemplateById(e){var s;this.loading=!0;try{await ie(e),this.templates=this.templates.filter(t=>t.template_id!==e),((s=this.currentTemplate)==null?void 0:s.template_id)===e&&(this.currentTemplate=null)}catch(t){throw console.error("Failed to delete template:",t),t}finally{this.loading=!1}},setFilter(e,s){this.filters[e]=s,this.pagination.page=1,this.fetchTemplates()},clearFilters(){this.filters={keyword:"",equipment_node_ids:[],category:"",search:"",asset:[],reference_id:""},this.pagination.page=1,this.fetchTemplates()},setPage(e){this.pagination.page=e},setPageSize(e){this.pagination.size=e,this.pagination.page=1,this.fetchTemplates()},setCurrentTemplate(e){this.currentTemplate=e},clearCurrentTemplate(){this.currentTemplate=null},transformApiTemplate(e){var s;return{template_id:e.id||e.template_id,id:e.id||e.template_id,name:e.name,description:e.description||"",category:e.category||"Uncategorized",estimated_minutes:e.time_estimate_sec?Math.round(e.time_estimate_sec/60):0,time_estimate_sec:e.time_estimate_sec,steps:e.steps||[],status:e.status,created_at:e.created_at,updated_at:e.updated_at,created_by:e.created_by,updated_by:e.updated_by,equipment_node_id:((s=e.equipment_node)==null?void 0:s.id)||e.equipment_node_id,file_list:e.file_list||[],reference_id:e.reference_id,...e}},addTemplateUpdateListener(e){this.templateUpdateListeners.push(e)},removeTemplateUpdateListener(e){const s=this.templateUpdateListeners.indexOf(e);s>-1&&this.templateUpdateListeners.splice(s,1)},emitTemplateUpdate(e){this.templateUpdateListeners.forEach(s=>{try{s(e)}catch(t){console.error("Error in template update listener:",t)}})}}}),ve=()=>({name:"",description:"",category_ids:[],priority_id:null,state_id:1,work_type_id:null,equipment_node_ids:[],vendor_ids:[],assignee_ids:[],approved_by_id:null,time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone,start_date:null,due_date:null,end_date:null,recurrence_type_id:null,recurrence_type:null,recurrence_setting:{},recurrence_setting_request:{start_date_time:null},task_list:[],image_list:[],file_list:[],standard_list:[],tasks:[],standards:[]}),j=e=>JSON.parse(JSON.stringify(e)),H=1;let Q=0;const X=()=>(Q+=1,`work-order-task-${Date.now()}-${Q}`),be=e=>{if(!e)return null;if(typeof e=="object"){if(e.id)return e.id;if(e.category_id)return e.category_id}const s=parseInt(e,10);return Number.isNaN(s)?null:s},Te=e=>{if(e.time_estimate_sec&&e.time_estimate_sec>0)return e.time_estimate_sec;if(e.timeEstimateSec&&e.timeEstimateSec>0)return e.timeEstimateSec;const s=e.estimated_minutes||e.estimatedMinutes||30;return(s>0?s:30)*60},Y=()=>({name:"Checklist",description:"Auto-generated step",type:"template",required:!1,remarks:"",value:{type:"checkbox",value:!1,require_image:!1,image:[]},tools:[]}),we=(e,s)=>{try{const t=de(e,s);return ce(t,!1)}catch(t){return console.error("Failed to normalize template step:",t),null}},E=(e,s)=>{if(e&&typeof e=="object"){if(Object.prototype.hasOwnProperty.call(e,"value")&&Object.prototype.hasOwnProperty.call(e,"label"))return{id:e.value??null,name:e.label??""};if(Object.prototype.hasOwnProperty.call(e,"id")||Object.prototype.hasOwnProperty.call(e,"name"))return{id:e.id??null,name:e.name??e.label??""}}return s&&typeof s=="object"&&(Object.prototype.hasOwnProperty.call(s,"id")||Object.prototype.hasOwnProperty.call(s,"name"))?{id:s.id??null,name:s.name??s.label??""}:typeof s=="string"&&s?{id:null,name:s}:typeof s=="number"?{id:s,name:String(s)}:null},Se=e=>{var r;const s=Array.isArray(e.steps)?e.steps.map((u,_)=>we(u,_)).filter(Boolean):[];s.length===0&&s.push(Y());const t=e.category||(e.category_name?{id:e.category_id??e.categoryId??null,name:e.category_name}:null),i=E(null,t),n={name:e.name||"Unnamed Task",description:e.description||"",time_estimate_sec:Te(e),steps:s,attachments:e.attachments||e.file_list||[],assignee_ids:[],equipment_node_id:e.equipment_node_id||((r=e.equipment_node)==null?void 0:r.id)||null,location_id:e.location_id??null,category_id:(i==null?void 0:i.id)??be(e.category)??e.category_id??null,category_name:(i==null?void 0:i.name)??e.category_name??null,work_order_id:0,state:H},l=e.template_id||e.id||e._id;return l&&(n.template_id=l),n},ke=e=>{const s=Se(e),t=Math.round((s.time_estimate_sec||0)/60)||0,i=e.category||(e.category_name?{id:e.category_id??e.categoryId??null,name:e.category_name}:null),n=E(null,i);return{id:X(),name:s.name,description:s.description,category:n||e.category,category_name:n==null?void 0:n.name,estimated_minutes:t,templateId:s.template_id,template_id:s.template_id,steps:e.steps||s.steps,source:"template",assignee_ids:s.assignee_ids||[],payload:s,rawTemplate:e}},Bt=(e,s=null)=>{const t=le(e);if(t.work_order_id=t.work_order_id??0,t.state=t.state??H,delete t.template_id,(!Array.isArray(t.steps)||t.steps.length===0)&&(t.steps=[Y()]),s){const l=s.value??s.id;l&&(t.category_id=l)}const i=E(s,e.category),n=e.estimated_minutes||Math.round((t.time_estimate_sec||0)/60)||0;return{id:X(),name:t.name,description:t.description,category:i||e.category,category_name:i==null?void 0:i.name,estimated_minutes:n,steps:t.steps,source:"adhoc",assignee_ids:t.assignee_ids||[],payload:t}},k=e=>JSON.parse(JSON.stringify(e)),Dt=J("workOrderDraft",{state:()=>({draftForm:null,returnRoute:null,returnPanel:null,returnWorkOrderId:null,shouldOpenCreatePanel:!1,currentContext:null,editModeOriginalData:null,originalTasks:null,originalStandards:null,pendingStandaloneTask:null}),getters:{hasDraft:e=>!!e.draftForm,isEditMode:e=>e.currentContext==="edit",isCreateMode:e=>e.currentContext==="create",hasValidContext:e=>e.currentContext==="edit"||e.currentContext==="create"},actions:{ensureDraft(){return this.draftForm||(this.draftForm=ve()),this.draftForm},saveDraft(e){if(this.currentContext==="edit"){const s=this.draftForm||j(e);s.tasks=j(e).tasks,s.standards=j(e).standards,this.draftForm=s}else this.draftForm=j(e)},saveContextAwareDraft(e,s){this.currentContext=s,this.saveDraft(e)},clearDraft(){this.draftForm=null},clearDraftAndContext(){this.draftForm=null,this.clearContext()},setReturnRoute(e){this.returnRoute=e},clearReturnRoute(){this.returnRoute=null},setReturnPanel(e){this.returnPanel=e||null},clearReturnPanel(){this.returnPanel=null},setReturnWorkOrderId(e){this.returnWorkOrderId=e??null},clearReturnWorkOrderId(){this.returnWorkOrderId=null},clearReturnContext(){this.returnRoute=null,this.returnPanel=null,this.returnWorkOrderId=null,this.shouldOpenCreatePanel=!1},setContext(e){this.currentContext=e},setEditModeData(e){this.currentContext="edit",this.editModeOriginalData=k(e),this.originalTasks=k(e.tasks||[]),this.originalStandards=k(e.standards||[])},setCreateMode(){this.currentContext="create",this.editModeOriginalData=null,this.originalTasks=null,this.originalStandards=null},clearContext(){this.currentContext=null,this.editModeOriginalData=null,this.originalTasks=null,this.originalStandards=null,this.pendingStandaloneTask=null},setShouldOpenCreatePanel(e){this.shouldOpenCreatePanel=e},setPendingStandaloneTask(e){this.pendingStandaloneTask=e?k(e):null},consumePendingStandaloneTask(){const e=this.pendingStandaloneTask?k(this.pendingStandaloneTask):null;return this.pendingStandaloneTask=null,e},appendTask(e){const s=this.ensureDraft();Array.isArray(s.tasks)||(s.tasks=[]);const t=k(e);t.source=t.source||(t.templateId||t.template_id?"template":"adhoc"),t.category&&typeof t.category=="object"&&(t.category_name=t.category_name||t.category.name||t.category.label),this.currentContext==="edit"&&(t.id=t.id||`new-task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),s.tasks.push(t),this.currentContext==="create"&&(s.task_list=s.tasks.map(i=>k(i.payload||{})).filter(i=>Object.keys(i).length>0))},updateTasksWithTemplate(e){if(!e)return;const s=this.ensureDraft();Array.isArray(s.tasks)||(s.tasks=[]);const t=e.template_id||e.id||e._id;t&&(s.tasks=s.tasks.map(i=>{var n,l;if(i.source==="template"&&(i.templateId===t||i.template_id===t)){const r=k(i.steps||((n=i.payload)==null?void 0:n.steps)||[]),u=ke(e);return{...i,...u,id:i.id,__originalSteps:r,payload:{...i.payload||{},...u.payload,__originalSteps:r},category_name:((l=u.category)==null?void 0:l.name)||u.category_name||i.category_name}}return i}),this.currentContext==="create"&&(s.task_list=s.tasks.map(i=>k(i.payload||{})).filter(i=>Object.keys(i).length>0)))},updateTask(e,s){if(!e||!s)return;const t=this.ensureDraft();Array.isArray(t.tasks)||(t.tasks=[]);const i=String(e);t.tasks=t.tasks.map(n=>{if((n.id!=null?String(n.id):null)===i){const r={...n,...s,id:i,task_id:i};return s.payload?r.payload={...s.payload,id:i,task_id:i}:n.payload&&(r.payload={...n.payload,name:s.name||n.payload.name,description:s.description||n.payload.description,estimated_minutes:s.estimated_minutes||n.payload.estimated_minutes,time_estimate_sec:(s.estimated_minutes||n.payload.estimated_minutes||30)*60,equipment_node_id:s.equipment_node_id||n.payload.equipment_node_id,steps:s.steps||n.payload.steps,id:i,task_id:i}),r}return n}),this.currentContext==="create"&&(t.task_list=t.tasks.map(n=>k(n.payload||{})).filter(n=>Object.keys(n).length>0))},appendStandard(e){const s=this.ensureDraft();Array.isArray(s.standards)||(s.standards=[]);const t=k(e);this.currentContext==="edit"&&(t.id=t.id||`new-standard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),s.standards.push(t),this.currentContext==="create"&&(s.standard_list=s.standards.map(i=>k(i.payload||i)).filter(i=>Object.keys(i).length>0))},updateStandard(e,s){if(!e||!s)return;const t=this.ensureDraft();Array.isArray(t.standards)||(t.standards=[]),t.standards=t.standards.map(i=>{if(i.id===e){const n={...i,...s,id:e};return s.payload?n.payload=s.payload:i.payload&&(n.payload={...i.payload,...s}),n}return i}),this.currentContext==="create"&&(t.standard_list=t.standards.map(i=>k(i.payload||i)).filter(i=>Object.keys(i).length>0))}}});function Lt(){const e=ge(),s=P(()=>e.loading),t=P(()=>e.templateDetailLoading),i=P(()=>e.templates),n=P(()=>e.filteredTemplates),l=P(()=>e.currentTemplate),r=P(()=>e.filters),u=P(()=>e.pagination),_=async(a={})=>{try{await e.fetchTemplates(a)}catch(o){A.error("Failed to load templates"),console.error("Failed to load templates:",o)}},h=async a=>{try{return await e.fetchTemplate(a)}catch(o){throw A.error("Failed to load template"),console.error("Failed to load template:",o),o}},d=async a=>{try{const o=await e.createNewTemplate(a);return z({title:"Success",message:"Template created successfully",type:"success"}),o}catch(o){throw A.error("Failed to create template"),console.error("Failed to create template:",o),o}},c=async(a,o)=>{try{return await e.updateTemplateById(a,o)}catch(x){throw A.error("Failed to update template"),console.error("Failed to update template:",x),x}},b=async a=>{try{await e.deleteTemplateById(a),z({title:"Success",message:"Template deleted successfully",type:"success"})}catch(o){throw A.error("Failed to delete template"),console.error("Failed to delete template:",o),o}},O=async a=>{try{await e.publishTemplateById(a),z({title:"Success",message:"Template published successfully",type:"success"})}catch(o){throw A.error("Failed to publish template"),console.error("Failed to publish template:",o),o}},I=(a,o)=>{e.setFilter(a,o)},B=()=>{e.clearFilters()},D=a=>{e.setPage(a)},L=a=>{e.setPageSize(a)},V=a=>{e.setCurrentTemplate(a)},$=()=>{e.clearCurrentTemplate()},ee=a=>i.value.find(o=>o.template_id===a),te=a=>i.value.filter(o=>o.status===a),se=a=>i.value.filter(o=>o.category===a),N=a=>{const o=[];return(!a.name||typeof a.name=="string"&&a.name.trim().length===0)&&o.push("Template name is required"),a.name&&typeof a.name=="string"&&a.name.trim().length>255&&o.push("Template name must be 255 characters or less"),(!a.category||typeof a.category=="string"&&a.category.trim().length===0)&&o.push("Category is required"),(!a.estimated_minutes||a.estimated_minutes<=0)&&o.push("Estimated minutes must be greater than 0"),a.estimated_minutes>480&&o.push("Estimated minutes cannot exceed 480 (8 hours)"),(!a.steps||a.steps.length===0)&&o.push("Template must have at least one step"),a.steps&&a.steps.length>0&&a.steps.forEach((x,M)=>{(!x.label||typeof x.label=="string"&&x.label.trim().length===0)&&o.push(`Step ${M+1}: Name is required`),x.type==="service"&&o.push(`Step ${M+1}: Service step type is currently not supported`);const U=["inspection","checkbox","number","text","attachments"];x.type&&!U.includes(x.type)&&o.push(`Step ${M+1}: Invalid step type '${x.type}'. Allowed types: ${U.join(", ")}`)}),a.description&&typeof a.description=="string"&&a.description.length>500&&o.push("Description must be 500 characters or less"),o};return{loading:s,templateDetailLoading:t,templates:i,filteredTemplates:n,currentTemplate:l,filters:r,pagination:u,loadTemplates:_,loadTemplate:h,createTemplate:d,updateTemplate:c,deleteTemplate:b,publishTemplate:O,setFilter:I,clearFilters:B,setPage:D,setPageSize:L,selectTemplate:V,clearSelection:$,getTemplateById:ee,getTemplatesByStatus:te,getTemplatesByCategory:se,validateTemplate:N,isTemplateValid:a=>N(a).length===0}}const xe={__name:"InspectionStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var _,h;s();const t=e,i=C(((h=(_=t.step)==null?void 0:_.config)==null?void 0:h.result)??(t.previewMode?"pass":null));F(()=>{var d,c;return(c=(d=t.step)==null?void 0:d.config)==null?void 0:c.result},d=>{t.interactive||(i.value=d??(t.previewMode?"pass":null))},{immediate:!0});const u={props:t,currentResult:i,getOptionLabel:d=>({pass:"Pass",fail:"Fail"})[d]||d,getOptionType:d=>i.value===d?d==="pass"?"success":"danger":"",setInspectionResult:d=>{t.interactive&&(i.value=d)},ref:C,watch:F,get InfoFilled(){return R},get Check(){return Z},get Close(){return G}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}},Ce={class:"inspection-step-preview"},Fe={class:"preview-label"},Pe={key:0,class:"required-asterisk"},Ae={key:0,class:"step-description"},qe={class:"inspection-options"},Oe={key:1,class:"config-note"};function Ie(e,s,t,i,n,l){var h;const r=S("el-icon"),u=S("el-button"),_=S("el-button-group");return f(),y("div",Ce,[m("div",Fe,[t.step.required?(f(),y("span",Pe,"*")):v("v-if",!0),w(g(t.step.label||"Inspection Result")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Ae,g(t.step.description),1)):v("v-if",!0),m("div",qe,[p(_,{style:{width:"100%"}},{default:T(()=>[(f(),y(pe,null,_e(["pass","fail"],d=>p(u,{key:d,type:i.getOptionType(d),class:K(["inspection-option",`option-${d}`]),disabled:!t.interactive,style:{width:"50%"},onClick:c=>t.interactive&&i.setInspectionResult(d)},{default:T(()=>[p(r,null,{default:T(()=>[d==="pass"?(f(),W(i.Check,{key:0})):v("v-if",!0),d==="fail"?(f(),W(i.Close,{key:1})):v("v-if",!0)]),_:2},1024),w(" "+g(i.getOptionLabel(d)),1)]),_:2},1032,["type","class","disabled","onClick"])),64))]),_:1})]),(h=t.step.config)!=null&&h.require_comment_on_fail?(f(),y("div",Oe,[p(r,null,{default:T(()=>[p(i.InfoFilled)]),_:1}),s[0]||(s[0]=w(" Comment required on fail "))])):v("v-if",!0)])}const jt=q(xe,[["render",Ie],["__scopeId","data-v-0df9cb0e"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/InspectionStepPreview.vue"]]),Be={__name:"CheckboxStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=C(((l=t.step.config)==null?void 0:l.default)||!1);F(()=>{var r;return(r=t.step.config)==null?void 0:r.default},r=>{t.interactive||(i.value=r||!1)},{immediate:!0});const n={props:t,currentValue:i,ref:C,watch:F};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},De={class:"checkbox-step-preview"},Le={key:0,class:"required-asterisk"},je={key:0,class:"step-description"};function Ve(e,s,t,i,n,l){var u;const r=S("el-checkbox");return f(),y("div",De,[p(r,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=_=>i.currentValue=_),disabled:!t.interactive,size:((u=t.step.config)==null?void 0:u.element_size)||"default"},{default:T(()=>[t.step.required?(f(),y("span",Le,"*")):v("v-if",!0),w(g(t.step.label||"Confirmation required"),1)]),_:1},8,["modelValue","disabled","size"]),t.step.description&&t.step.description.trim()?(f(),y("div",je,g(t.step.description),1)):v("v-if",!0)])}const Vt=q(Be,[["render",Ve],["__scopeId","data-v-f3480c28"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/CheckboxStepPreview.vue"]]),Me={__name:"NumberStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=C(((l=t.step.config)==null?void 0:l.default)||0);F(()=>{var r;return(r=t.step.config)==null?void 0:r.default},r=>{t.interactive||(i.value=r||0)},{immediate:!0});const n={props:t,currentValue:i,ref:C,watch:F,get InfoFilled(){return R},get formatLimitsText(){return ue}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},ze={class:"number-step-preview"},Re={class:"preview-label"},Ee={key:0,class:"required-asterisk"},Ne={key:0,class:"step-description"},Ue={class:"number-input-preview"},We={key:0,class:"unit-label"},Qe={key:1,class:"limits-info"};function Je(e,s,t,i,n,l){var _,h,d,c;const r=S("el-input-number"),u=S("el-icon");return f(),y("div",ze,[m("div",Re,[t.step.required?(f(),y("span",Ee,"*")):v("v-if",!0),w(g(t.step.label||"Number Input")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Ne,g(t.step.description),1)):v("v-if",!0),m("div",Ue,[p(r,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=b=>i.currentValue=b),precision:((_=t.step.config)==null?void 0:_.decimal_places)||0,disabled:!t.interactive,style:{width:"100%"}},null,8,["modelValue","precision","disabled"]),(h=t.step.config)!=null&&h.unit?(f(),y("span",We,g(t.step.config.unit),1)):v("v-if",!0)]),(d=t.step.config)!=null&&d.limits&&i.formatLimitsText(t.step.config.limits)!=="No limits set"?(f(),y("div",Qe,[p(u,null,{default:T(()=>[p(i.InfoFilled)]),_:1}),w(" Range: "+g(i.formatLimitsText(t.step.config.limits,(c=t.step.config)==null?void 0:c.unit)),1)])):v("v-if",!0)])}const Mt=q(Me,[["render",Je],["__scopeId","data-v-e6279aee"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/NumberStepPreview.vue"]]),Ke={__name:"TextStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=C(((l=t.step.config)==null?void 0:l.default)||"");F(()=>{var r;return(r=t.step.config)==null?void 0:r.default},r=>{t.interactive||(i.value=r||"")},{immediate:!0});const n={props:t,currentValue:i,ref:C,watch:F,get InfoFilled(){return R}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},Ge={class:"text-step-preview"},Ze={class:"preview-label"},He={key:0,class:"required-asterisk"},Xe={key:0,class:"step-description"},Ye={key:1,class:"config-note"};function $e(e,s,t,i,n,l){var _,h,d,c,b,O,I,B,D,L;const r=S("el-input"),u=S("el-icon");return f(),y("div",Ge,[m("div",Ze,[t.step.required?(f(),y("span",He,"*")):v("v-if",!0),w(g(t.step.label||"Text Input")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Xe,g(t.step.description),1)):v("v-if",!0),p(r,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=V=>i.currentValue=V),type:(_=t.step.config)!=null&&_.multiline?"textarea":"text",rows:(h=t.step.config)!=null&&h.multiline?3:1,placeholder:t.step.placeholder||"Enter text here...",maxlength:(d=t.step.config)==null?void 0:d.max_length,"show-word-limit":((b=(c=t.step.config)==null?void 0:c.input_style)==null?void 0:b.show_word_limit)!==!1,clearable:((I=(O=t.step.config)==null?void 0:O.input_style)==null?void 0:I.clearable)!==!1,size:((D=(B=t.step.config)==null?void 0:B.input_style)==null?void 0:D.size)||"default",disabled:!t.interactive},null,8,["modelValue","type","rows","placeholder","maxlength","show-word-limit","clearable","size","disabled"]),(L=t.step.config)!=null&&L.max_length?(f(),y("div",Ye,[p(u,null,{default:T(()=>[p(i.InfoFilled)]),_:1}),w(" Maximum "+g(t.step.config.max_length)+" characters ",1)])):v("v-if",!0)])}const zt=q(Ke,[["render",$e],["__scopeId","data-v-b106a4f3"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/TextStepPreview.vue"]]),et={__name:"AttachmentStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){s();const i={props:e,get UploadFilled(){return he},get Files(){return ye},get DocumentAdd(){return fe},get DataAnalysis(){return me}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},tt={class:"attachment-step-preview"},st={class:"preview-label"},it={key:0,class:"required-asterisk"},nt={key:0,class:"step-description"},rt={class:"upload-config"},at={class:"config-item"},ot={class:"config-item"},lt={class:"config-item"};function dt(e,s,t,i,n,l){var _,h,d,c,b;const r=S("el-icon"),u=S("el-upload");return f(),y("div",tt,[m("div",st,[t.step.required?(f(),y("span",it,"*")):v("v-if",!0),w(g(t.step.label||"File Upload")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",nt,g(t.step.description),1)):v("v-if",!0),m("div",{class:K(["upload-preview",{interactive:t.interactive}])},[p(u,{class:"upload-demo",drag:"",disabled:!t.interactive,"show-file-list":!1,"list-type":((h=(_=t.step.config)==null?void 0:_.upload_style)==null?void 0:h.list_type)||"picture-card"},{default:T(()=>[p(r,{class:"el-icon--upload"},{default:T(()=>[p(i.UploadFilled)]),_:1}),s[0]||(s[0]=m("div",{class:"el-upload__text"},"Add images or files",-1))]),_:1,__:[0]},8,["disabled","list-type"])],2),m("div",rt,[m("div",at,[p(r,null,{default:T(()=>[p(i.Files)]),_:1}),w(" Max "+g(((d=t.step.config)==null?void 0:d.max_files)||5)+" files ",1)]),m("div",ot,[p(r,null,{default:T(()=>[p(i.DocumentAdd)]),_:1}),w(" "+g((((c=t.step.config)==null?void 0:c.allow_types)||["image","pdf"]).join(", ")),1)]),m("div",lt,[p(r,null,{default:T(()=>[p(i.DataAnalysis)]),_:1}),w(" Max "+g(((b=t.step.config)==null?void 0:b.max_file_size_mb)||25)+"MB per file ",1)])])])}const Rt=q(et,[["render",dt],["__scopeId","data-v-b1d80d8a"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/AttachmentStepPreview.vue"]]),ct={__name:"ServiceStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var h,d;s();const t=e,i=C(((h=t.step.config)==null?void 0:h.quantity)||1),n=C(((d=t.step.config)==null?void 0:d.status)||"fail");F(()=>{var c;return(c=t.step.config)==null?void 0:c.quantity},c=>{t.interactive||(i.value=c||1)},{immediate:!0}),F(()=>{var c;return(c=t.step.config)==null?void 0:c.status},c=>{t.interactive||(n.value=c||"fail")},{immediate:!0});const _={props:t,currentQuantity:i,currentStatus:n,getServiceTypeTagType:c=>c==="Replace"?"danger":"warning",getStatusButtonType:c=>c===n.value?c==="pass"?"success":"danger":"info",setStatus:c=>{t.interactive&&(n.value=c)},ref:C,watch:F,get Check(){return Z},get Close(){return G}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}},ut={class:"service-step-preview"},pt={class:"preview-label"},_t={key:0,class:"required-asterisk"},mt={key:0,class:"step-description"},ft={class:"service-config-preview"},yt={class:"config-row"},ht={class:"config-column"},gt={class:"config-item"},vt={class:"config-item"},bt={class:"config-column"},Tt={class:"config-item",style:{width:"100%"}},wt={class:"config-row"},St={class:"config-item status-row"};function kt(e,s,t,i,n,l){var c;const r=S("el-tag"),u=S("el-input-number"),_=S("el-icon"),h=S("el-button"),d=S("el-button-group");return f(),y("div",ut,[m("div",pt,[t.step.required?(f(),y("span",_t,"*")):v("v-if",!0),w(g(t.step.label||"Service Operation")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",mt,g(t.step.description),1)):v("v-if",!0),m("div",ft,[v(" First Row "),m("div",yt,[m("div",ht,[m("div",gt,[s[3]||(s[3]=m("span",{class:"config-label"},"Service Type:",-1)),p(r,{type:i.getServiceTypeTagType((c=t.step.config)==null?void 0:c.service_type),size:"small"},{default:T(()=>{var b;return[w(g(((b=t.step.config)==null?void 0:b.service_type)||"Replace"),1)]}),_:1},8,["type"])]),m("div",vt,[s[4]||(s[4]=m("span",{class:"config-label"},"Device Tag:",-1)),p(r,{type:"info",size:"small",class:"device-tag"},{default:T(()=>{var b;return[w(g(((b=t.step.config)==null?void 0:b.device_tag)||"P100016"),1)]}),_:1})])]),m("div",bt,[m("div",Tt,[s[5]||(s[5]=m("span",{class:"config-label"},"Quantity:",-1)),p(u,{modelValue:i.currentQuantity,"onUpdate:modelValue":s[0]||(s[0]=b=>i.currentQuantity=b),min:1,max:999,step:1,precision:0,size:"small",disabled:!t.interactive,style:{width:"100%"},class:"quantity-input-preview"},null,8,["modelValue","disabled"])])])]),v(" Second Row "),m("div",wt,[m("div",St,[p(d,{class:"pass-fail-group"},{default:T(()=>[p(h,{type:i.getStatusButtonType("pass"),size:"small",disabled:!t.interactive,class:"status-button",onClick:s[1]||(s[1]=b=>t.interactive&&i.setStatus("pass"))},{default:T(()=>[p(_,null,{default:T(()=>[p(i.Check)]),_:1}),s[6]||(s[6]=w(" Pass "))]),_:1,__:[6]},8,["type","disabled"]),p(h,{type:i.getStatusButtonType("fail"),size:"small",disabled:!t.interactive,class:"status-button",onClick:s[2]||(s[2]=b=>t.interactive&&i.setStatus("fail"))},{default:T(()=>[p(_,null,{default:T(()=>[p(i.Close)]),_:1}),s[7]||(s[7]=w(" Fail "))]),_:1,__:[7]},8,["type","disabled"])]),_:1})])])])])}const Et=q(ct,[["render",kt],["__scopeId","data-v-bfaa008e"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/ServiceStepPreview.vue"]]);export{Rt as A,Vt as C,H as D,jt as I,Mt as N,Et as S,zt as T,Dt as a,ge as b,ve as c,j as d,ke as e,Bt as f,Lt as u};
