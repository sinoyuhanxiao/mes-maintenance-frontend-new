import{d as J}from"../pinia/pinia.CzPcBe5J.js";import{b as ie,e as re,f as ne,h as ae,s as oe,i as le,j as ce,k as de,l as ue}from"../task-library/task-library.mnROmZvc.js";import"../vue/vue.Dfo81L2Q.js";import{f as z,E as P}from"../element-plus/element-plus.CU5xiOkY.js";import{j as A,am as S,c as y,o as f,a as _,O as v,Q as T,R as g,S as u,L as w,F as pe,a8 as me,G as K,K as W,r as x,w as C}from"../@vue/@vue.CVGyaoMH.js";import{a as G,j as Z,i as R,aq as _e,aa as fe,ar as ye,af as he}from"../@element-plus/@element-plus.BNeHluFm.js";import{_ as q}from"../../assets/index-fCswSekQ.js";const ge=J("taskLibrary",{state:()=>({templates:[],currentTemplate:null,loading:!1,templateDetailLoading:!1,filters:{keyword:"",equipment_node_ids:[],category:"",search:"",asset:[],reference_id:""},pagination:{page:1,size:20,total:0,sortField:"createdAt",direction:"DESC"},templateUpdateListeners:[]}),getters:{filteredTemplates:e=>Array.isArray(e.templates)?e.templates:[],templateCategories:e=>Array.isArray(e.templates)?[...new Set(e.templates.map(t=>t.category))].filter(Boolean):[],publishedTemplates:e=>Array.isArray(e.templates)?e.templates.filter(s=>s.status==="published"):[],draftTemplates:e=>Array.isArray(e.templates)?e.templates.filter(s=>s.status==="draft"):[]},actions:{async fetchTemplates(e={}){this.loading=!0;try{const s={},t=this.filters.keyword||this.filters.search||"";t.trim()&&(s.keyword=t.trim());const i=this.filters.reference_id||"";i.trim()&&(s.reference_id=i.trim());const r=this.filters.equipment_node_ids.length>0?this.filters.equipment_node_ids:this.filters.asset||[];Array.isArray(r)&&r.length>0&&(s.equipment_node_ids=r),e.reference_id&&(s.reference_id=e.reference_id),e.step_ids&&Array.isArray(e.step_ids)&&e.step_ids.length>0&&(s.step_ids=e.step_ids);const l=await oe(this.pagination.page,this.pagination.size,this.pagination.sortField,this.pagination.direction,s),a=l.data.content||[];this.templates=Array.isArray(a)?a.map(this.transformApiTemplate):[],this.pagination.total=l.data.totalElements||0}catch(s){throw console.error("Failed to fetch templates:",s),this.templates=[],this.pagination.total=0,s}finally{this.loading=!1}},async fetchTemplate(e){this.templateDetailLoading=!0;try{const s=await ae(e);return this.currentTemplate=s.data,s.data}catch(s){throw console.error("Failed to fetch template:",s),s}finally{this.templateDetailLoading=!1}},async createNewTemplate(e){this.loading=!0;try{const t=(await ne(e)).data,i=this.transformApiTemplate(t);return this.templates.unshift(i),this.currentTemplate=i,i}catch(s){throw console.error("Failed to create template:",s),s}finally{this.loading=!1}},async updateCurrentTemplate(e){if(this.currentTemplate)return await this.updateTemplateById(this.currentTemplate.template_id||this.currentTemplate.id,e)},async updateTemplateById(e,s){this.loading=!0;try{let t=null;if(this.currentTemplate&&(this.currentTemplate.template_id===e||this.currentTemplate.id===e))t=this.currentTemplate;else{const m=this.templates.find(p=>p.template_id===e||p.id===e);if(m)t=m;else try{t=await this.fetchTemplate(e)}catch(p){console.warn("Failed to fetch original template:",p)}}const r=(await re(e,s,t)).data,l=this.transformApiTemplate(r),a=this.templates.findIndex(m=>m.template_id===e||m.id===e);return a!==-1&&(this.templates[a]=l),this.currentTemplate&&(this.currentTemplate.template_id===e||this.currentTemplate.id===e)&&(this.currentTemplate=l),this.emitTemplateUpdate(l),l}catch(t){throw console.error("Failed to update template:",t),t}finally{this.loading=!1}},async deleteTemplateById(e){var s;this.loading=!0;try{await ie(e),this.templates=this.templates.filter(t=>t.template_id!==e),((s=this.currentTemplate)==null?void 0:s.template_id)===e&&(this.currentTemplate=null)}catch(t){throw console.error("Failed to delete template:",t),t}finally{this.loading=!1}},setFilter(e,s){this.filters[e]=s,this.pagination.page=1,this.fetchTemplates()},clearFilters(){this.filters={keyword:"",equipment_node_ids:[],category:"",search:"",asset:[],reference_id:""},this.pagination.page=1,this.fetchTemplates()},setPage(e){this.pagination.page=e},setPageSize(e){this.pagination.size=e,this.pagination.page=1,this.fetchTemplates()},setCurrentTemplate(e){this.currentTemplate=e},clearCurrentTemplate(){this.currentTemplate=null},transformApiTemplate(e){var s;return{template_id:e.id||e.template_id,id:e.id||e.template_id,name:e.name,description:e.description||"",category:e.category||"Uncategorized",estimated_minutes:e.time_estimate_sec?Math.round(e.time_estimate_sec/60):0,time_estimate_sec:e.time_estimate_sec,steps:e.steps||[],status:e.status,created_at:e.created_at,updated_at:e.updated_at,created_by:e.created_by,updated_by:e.updated_by,equipment_node_id:((s=e.equipment_node)==null?void 0:s.id)||e.equipment_node_id,file_list:e.file_list||[],reference_id:e.reference_id,...e}},addTemplateUpdateListener(e){this.templateUpdateListeners.push(e)},removeTemplateUpdateListener(e){const s=this.templateUpdateListeners.indexOf(e);s>-1&&this.templateUpdateListeners.splice(s,1)},emitTemplateUpdate(e){this.templateUpdateListeners.forEach(s=>{try{s(e)}catch(t){console.error("Error in template update listener:",t)}})}}}),ve=()=>({name:"",description:"",category_ids:[],priority_id:null,state_id:1,work_type_id:null,equipment_node_ids:[],vendor_ids:[],approved_by_id:null,time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone,start_date:null,due_date:null,end_date:null,recurrence_type_id:null,recurrence_type:null,recurrence_setting:{},recurrence_setting_request:{start_date_time:null},task_list:[],image_list:[],file_list:[],standard_list:[],tasks:[],standards:[]}),j=e=>JSON.parse(JSON.stringify(e)),H=1;let Q=0;const X=()=>(Q+=1,`work-order-task-${Date.now()}-${Q}`),be=e=>{if(!e)return null;if(typeof e=="object"){if(e.id)return e.id;if(e.category_id)return e.category_id}const s=parseInt(e,10);return Number.isNaN(s)?null:s},we=e=>{if(e.time_estimate_sec&&e.time_estimate_sec>0)return e.time_estimate_sec;if(e.timeEstimateSec&&e.timeEstimateSec>0)return e.timeEstimateSec;const s=e.estimated_minutes||e.estimatedMinutes||30;return(s>0?s:30)*60},Y=()=>({name:"Checklist",description:"Auto-generated step",type:"template",required:!1,remarks:"",value:{type:"checkbox",value:!1,require_image:!1,image:[]},tools:[]}),Te=(e,s)=>{try{const t=ce(e,s);return de(t,!1)}catch(t){return console.error("Failed to normalize template step:",t),null}},E=(e,s)=>{if(e&&typeof e=="object"){if(Object.prototype.hasOwnProperty.call(e,"value")&&Object.prototype.hasOwnProperty.call(e,"label"))return{id:e.value??null,name:e.label??""};if(Object.prototype.hasOwnProperty.call(e,"id")||Object.prototype.hasOwnProperty.call(e,"name"))return{id:e.id??null,name:e.name??e.label??""}}return s&&typeof s=="object"&&(Object.prototype.hasOwnProperty.call(s,"id")||Object.prototype.hasOwnProperty.call(s,"name"))?{id:s.id??null,name:s.name??s.label??""}:typeof s=="string"&&s?{id:null,name:s}:typeof s=="number"?{id:s,name:String(s)}:null},Se=e=>{var a;const s=Array.isArray(e.steps)?e.steps.map((m,p)=>Te(m,p)).filter(Boolean):[];s.length===0&&s.push(Y());const t=e.category||(e.category_name?{id:e.category_id??e.categoryId??null,name:e.category_name}:null),i=E(null,t),r={name:e.name||"Unnamed Task",description:e.description||"",time_estimate_sec:we(e),steps:s,attachments:e.attachments||e.file_list||[],assignee_ids:[],equipment_node_id:e.equipment_node_id||((a=e.equipment_node)==null?void 0:a.id)||null,location_id:e.location_id??null,category_id:(i==null?void 0:i.id)??be(e.category)??e.category_id??null,category_name:(i==null?void 0:i.name)??e.category_name??null,work_order_id:0,state:H},l=e.template_id||e.id||e._id;return l&&(r.template_id=l),r},ke=e=>{const s=Se(e),t=Math.round((s.time_estimate_sec||0)/60)||0,i=e.category||(e.category_name?{id:e.category_id??e.categoryId??null,name:e.category_name}:null),r=E(null,i);return{id:X(),name:s.name,description:s.description,category:r||e.category,category_name:r==null?void 0:r.name,estimated_minutes:t,templateId:s.template_id,template_id:s.template_id,steps:e.steps||s.steps,source:"template",assignee_ids:s.assignee_ids||[],payload:s,rawTemplate:e}},Bt=(e,s=null)=>{const t=le(e);if(t.work_order_id=t.work_order_id??0,t.state=t.state??H,delete t.template_id,(!Array.isArray(t.steps)||t.steps.length===0)&&(t.steps=[Y()]),s){const l=s.value??s.id;l&&(t.category_id=l)}const i=E(s,e.category),r=e.estimated_minutes||Math.round((t.time_estimate_sec||0)/60)||0;return{id:X(),name:t.name,description:t.description,category:i||e.category,category_name:i==null?void 0:i.name,estimated_minutes:r,steps:t.steps,source:"adhoc",assignee_ids:t.assignee_ids||[],payload:t}},F=e=>JSON.parse(JSON.stringify(e)),Dt=J("workOrderDraft",{state:()=>({draftForm:null,returnRoute:null,returnPanel:null,returnWorkOrderId:null,shouldOpenCreatePanel:!1,currentContext:null,editModeOriginalData:null,originalTasks:null,originalStandards:null}),getters:{hasDraft:e=>!!e.draftForm,isEditMode:e=>e.currentContext==="edit",isCreateMode:e=>e.currentContext==="create",hasValidContext:e=>e.currentContext==="edit"||e.currentContext==="create"},actions:{ensureDraft(){return this.draftForm||(this.draftForm=ve()),this.draftForm},saveDraft(e){if(this.currentContext==="edit"){const s=this.draftForm||j(e);s.tasks=j(e).tasks,s.standards=j(e).standards,this.draftForm=s}else this.draftForm=j(e)},saveContextAwareDraft(e,s){this.currentContext=s,this.saveDraft(e)},clearDraft(){this.draftForm=null},clearDraftAndContext(){this.draftForm=null,this.clearContext()},setReturnRoute(e){this.returnRoute=e},clearReturnRoute(){this.returnRoute=null},setReturnPanel(e){this.returnPanel=e||null},clearReturnPanel(){this.returnPanel=null},setReturnWorkOrderId(e){this.returnWorkOrderId=e??null},clearReturnWorkOrderId(){this.returnWorkOrderId=null},clearReturnContext(){this.returnRoute=null,this.returnPanel=null,this.returnWorkOrderId=null,this.shouldOpenCreatePanel=!1},setContext(e){this.currentContext=e},setEditModeData(e){this.currentContext="edit",this.editModeOriginalData=F(e),this.originalTasks=F(e.tasks||[]),this.originalStandards=F(e.standards||[])},setCreateMode(){this.currentContext="create",this.editModeOriginalData=null,this.originalTasks=null,this.originalStandards=null},clearContext(){this.currentContext=null,this.editModeOriginalData=null,this.originalTasks=null,this.originalStandards=null},setShouldOpenCreatePanel(e){this.shouldOpenCreatePanel=e},appendTask(e){const s=this.ensureDraft();Array.isArray(s.tasks)||(s.tasks=[]);const t=F(e);t.source=t.source||(t.templateId||t.template_id?"template":"adhoc"),t.category&&typeof t.category=="object"&&(t.category_name=t.category_name||t.category.name||t.category.label),this.currentContext==="edit"&&(t.id=t.id||`new-task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),s.tasks.push(t),this.currentContext==="create"&&(s.task_list=s.tasks.map(i=>F(i.payload||{})).filter(i=>Object.keys(i).length>0))},updateTasksWithTemplate(e){if(!e)return;const s=this.ensureDraft();Array.isArray(s.tasks)||(s.tasks=[]);const t=e.template_id||e.id||e._id;t&&(s.tasks=s.tasks.map(i=>{var r;if(i.source==="template"&&(i.templateId===t||i.template_id===t)){const l=ke(e);return{...i,...l,id:i.id,payload:{...i.payload||{},...l.payload},category_name:((r=l.category)==null?void 0:r.name)||l.category_name||i.category_name}}return i}),this.currentContext==="create"&&(s.task_list=s.tasks.map(i=>F(i.payload||{})).filter(i=>Object.keys(i).length>0)))},updateTask(e,s){if(!e||!s)return;const t=this.ensureDraft();Array.isArray(t.tasks)||(t.tasks=[]),t.tasks=t.tasks.map(i=>{if(i.id===e){const r={...i,...s,id:e};return s.payload?r.payload=s.payload:i.payload&&(r.payload={...i.payload,name:s.name||i.payload.name,description:s.description||i.payload.description,estimated_minutes:s.estimated_minutes||i.payload.estimated_minutes,time_estimate_sec:(s.estimated_minutes||i.payload.estimated_minutes||30)*60,equipment_node_id:s.equipment_node_id||i.payload.equipment_node_id,steps:s.steps||i.payload.steps}),r}return i}),this.currentContext==="create"&&(t.task_list=t.tasks.map(i=>F(i.payload||{})).filter(i=>Object.keys(i).length>0))},appendStandard(e){const s=this.ensureDraft();Array.isArray(s.standards)||(s.standards=[]);const t=F(e);this.currentContext==="edit"&&(t.id=t.id||`new-standard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),s.standards.push(t),this.currentContext==="create"&&(s.standard_list=s.standards.map(i=>F(i.payload||i)).filter(i=>Object.keys(i).length>0))},updateStandard(e,s){if(!e||!s)return;const t=this.ensureDraft();Array.isArray(t.standards)||(t.standards=[]),t.standards=t.standards.map(i=>{if(i.id===e){const r={...i,...s,id:e};return s.payload?r.payload=s.payload:i.payload&&(r.payload={...i.payload,...s}),r}return i}),this.currentContext==="create"&&(t.standard_list=t.standards.map(i=>F(i.payload||i)).filter(i=>Object.keys(i).length>0))}}});function Lt(){const e=ge(),s=A(()=>e.loading),t=A(()=>e.templateDetailLoading),i=A(()=>e.templates),r=A(()=>e.filteredTemplates),l=A(()=>e.currentTemplate),a=A(()=>e.filters),m=A(()=>e.pagination),p=async(n={})=>{try{await e.fetchTemplates(n)}catch(o){P.error("Failed to load templates"),console.error("Failed to load templates:",o)}},h=async n=>{try{return await e.fetchTemplate(n)}catch(o){throw P.error("Failed to load template"),console.error("Failed to load template:",o),o}},c=async n=>{try{const o=await e.createNewTemplate(n);return z({title:"Success",message:"Template created successfully",type:"success"}),o}catch(o){throw P.error("Failed to create template"),console.error("Failed to create template:",o),o}},d=async(n,o)=>{try{const k=await e.updateTemplateById(n,o);return P.success("Template updated successfully"),k}catch(k){throw P.error("Failed to update template"),console.error("Failed to update template:",k),k}},b=async n=>{try{await e.deleteTemplateById(n),z({title:"Success",message:"Template deleted successfully",type:"success"})}catch(o){throw P.error("Failed to delete template"),console.error("Failed to delete template:",o),o}},O=async n=>{try{await e.publishTemplateById(n),z({title:"Success",message:"Template published successfully",type:"success"})}catch(o){throw P.error("Failed to publish template"),console.error("Failed to publish template:",o),o}},I=(n,o)=>{e.setFilter(n,o)},B=()=>{e.clearFilters()},D=n=>{e.setPage(n)},L=n=>{e.setPageSize(n)},V=n=>{e.setCurrentTemplate(n)},$=()=>{e.clearCurrentTemplate()},ee=n=>i.value.find(o=>o.template_id===n),te=n=>i.value.filter(o=>o.status===n),se=n=>i.value.filter(o=>o.category===n),N=n=>{const o=[];return(!n.name||typeof n.name=="string"&&n.name.trim().length===0)&&o.push("Template name is required"),n.name&&typeof n.name=="string"&&n.name.trim().length>255&&o.push("Template name must be 255 characters or less"),(!n.category||typeof n.category=="string"&&n.category.trim().length===0)&&o.push("Category is required"),(!n.estimated_minutes||n.estimated_minutes<=0)&&o.push("Estimated minutes must be greater than 0"),n.estimated_minutes>480&&o.push("Estimated minutes cannot exceed 480 (8 hours)"),(!n.steps||n.steps.length===0)&&o.push("Template must have at least one step"),n.steps&&n.steps.length>0&&n.steps.forEach((k,M)=>{(!k.label||typeof k.label=="string"&&k.label.trim().length===0)&&o.push(`Step ${M+1}: Name is required`),k.type==="service"&&o.push(`Step ${M+1}: Service step type is currently not supported`);const U=["inspection","checkbox","number","text","attachments"];k.type&&!U.includes(k.type)&&o.push(`Step ${M+1}: Invalid step type '${k.type}'. Allowed types: ${U.join(", ")}`)}),n.description&&typeof n.description=="string"&&n.description.length>500&&o.push("Description must be 500 characters or less"),o};return{loading:s,templateDetailLoading:t,templates:i,filteredTemplates:r,currentTemplate:l,filters:a,pagination:m,loadTemplates:p,loadTemplate:h,createTemplate:c,updateTemplate:d,deleteTemplate:b,publishTemplate:O,setFilter:I,clearFilters:B,setPage:D,setPageSize:L,selectTemplate:V,clearSelection:$,getTemplateById:ee,getTemplatesByStatus:te,getTemplatesByCategory:se,validateTemplate:N,isTemplateValid:n=>N(n).length===0}}const xe={__name:"InspectionStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var p,h;s();const t=e,i=x(((h=(p=t.step)==null?void 0:p.config)==null?void 0:h.result)??(t.previewMode?"pass":null));C(()=>{var c,d;return(d=(c=t.step)==null?void 0:c.config)==null?void 0:d.result},c=>{t.interactive||(i.value=c??(t.previewMode?"pass":null))},{immediate:!0});const m={props:t,currentResult:i,getOptionLabel:c=>({pass:"Pass",fail:"Fail"})[c]||c,getOptionType:c=>i.value===c?c==="pass"?"success":"danger":"",setInspectionResult:c=>{t.interactive&&(i.value=c)},ref:x,watch:C,get InfoFilled(){return R},get Check(){return Z},get Close(){return G}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}},Ce={class:"inspection-step-preview"},Fe={class:"preview-label"},Pe={key:0,class:"required-asterisk"},Ae={key:0,class:"step-description"},qe={class:"inspection-options"},Oe={key:1,class:"config-note"};function Ie(e,s,t,i,r,l){var h;const a=S("el-icon"),m=S("el-button"),p=S("el-button-group");return f(),y("div",Ce,[_("div",Fe,[t.step.required?(f(),y("span",Pe,"*")):v("v-if",!0),T(g(t.step.label||"Inspection Result")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Ae,g(t.step.description),1)):v("v-if",!0),_("div",qe,[u(p,{style:{width:"100%"}},{default:w(()=>[(f(),y(pe,null,me(["pass","fail"],c=>u(m,{key:c,type:i.getOptionType(c),class:K(["inspection-option",`option-${c}`]),disabled:!t.interactive,style:{width:"50%"},onClick:d=>t.interactive&&i.setInspectionResult(c)},{default:w(()=>[u(a,null,{default:w(()=>[c==="pass"?(f(),W(i.Check,{key:0})):v("v-if",!0),c==="fail"?(f(),W(i.Close,{key:1})):v("v-if",!0)]),_:2},1024),T(" "+g(i.getOptionLabel(c)),1)]),_:2},1032,["type","class","disabled","onClick"])),64))]),_:1})]),(h=t.step.config)!=null&&h.require_comment_on_fail?(f(),y("div",Oe,[u(a,null,{default:w(()=>[u(i.InfoFilled)]),_:1}),s[0]||(s[0]=T(" Comment required on fail "))])):v("v-if",!0)])}const jt=q(xe,[["render",Ie],["__scopeId","data-v-0df9cb0e"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/InspectionStepPreview.vue"]]),Be={__name:"CheckboxStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=x(((l=t.step.config)==null?void 0:l.default)||!1);C(()=>{var a;return(a=t.step.config)==null?void 0:a.default},a=>{t.interactive||(i.value=a||!1)},{immediate:!0});const r={props:t,currentValue:i,ref:x,watch:C};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}},De={class:"checkbox-step-preview"},Le={key:0,class:"required-asterisk"},je={key:0,class:"step-description"};function Ve(e,s,t,i,r,l){var m;const a=S("el-checkbox");return f(),y("div",De,[u(a,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=p=>i.currentValue=p),disabled:!t.interactive,size:((m=t.step.config)==null?void 0:m.element_size)||"default"},{default:w(()=>[t.step.required?(f(),y("span",Le,"*")):v("v-if",!0),T(g(t.step.label||"Confirmation required"),1)]),_:1},8,["modelValue","disabled","size"]),t.step.description&&t.step.description.trim()?(f(),y("div",je,g(t.step.description),1)):v("v-if",!0)])}const Vt=q(Be,[["render",Ve],["__scopeId","data-v-f3480c28"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/CheckboxStepPreview.vue"]]),Me={__name:"NumberStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=x(((l=t.step.config)==null?void 0:l.default)||0);C(()=>{var a;return(a=t.step.config)==null?void 0:a.default},a=>{t.interactive||(i.value=a||0)},{immediate:!0});const r={props:t,currentValue:i,ref:x,watch:C,get InfoFilled(){return R},get formatLimitsText(){return ue}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}},ze={class:"number-step-preview"},Re={class:"preview-label"},Ee={key:0,class:"required-asterisk"},Ne={key:0,class:"step-description"},Ue={class:"number-input-preview"},We={key:0,class:"unit-label"},Qe={key:1,class:"limits-info"};function Je(e,s,t,i,r,l){var p,h,c,d;const a=S("el-input-number"),m=S("el-icon");return f(),y("div",ze,[_("div",Re,[t.step.required?(f(),y("span",Ee,"*")):v("v-if",!0),T(g(t.step.label||"Number Input")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Ne,g(t.step.description),1)):v("v-if",!0),_("div",Ue,[u(a,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=b=>i.currentValue=b),precision:((p=t.step.config)==null?void 0:p.decimal_places)||0,disabled:!t.interactive,style:{width:"100%"}},null,8,["modelValue","precision","disabled"]),(h=t.step.config)!=null&&h.unit?(f(),y("span",We,g(t.step.config.unit),1)):v("v-if",!0)]),(c=t.step.config)!=null&&c.limits&&i.formatLimitsText(t.step.config.limits)!=="No limits set"?(f(),y("div",Qe,[u(m,null,{default:w(()=>[u(i.InfoFilled)]),_:1}),T(" Range: "+g(i.formatLimitsText(t.step.config.limits,(d=t.step.config)==null?void 0:d.unit)),1)])):v("v-if",!0)])}const Mt=q(Me,[["render",Je],["__scopeId","data-v-e6279aee"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/NumberStepPreview.vue"]]),Ke={__name:"TextStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var l;s();const t=e,i=x(((l=t.step.config)==null?void 0:l.default)||"");C(()=>{var a;return(a=t.step.config)==null?void 0:a.default},a=>{t.interactive||(i.value=a||"")},{immediate:!0});const r={props:t,currentValue:i,ref:x,watch:C,get InfoFilled(){return R}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}},Ge={class:"text-step-preview"},Ze={class:"preview-label"},He={key:0,class:"required-asterisk"},Xe={key:0,class:"step-description"},Ye={key:1,class:"config-note"};function $e(e,s,t,i,r,l){var p,h,c,d,b,O,I,B,D,L;const a=S("el-input"),m=S("el-icon");return f(),y("div",Ge,[_("div",Ze,[t.step.required?(f(),y("span",He,"*")):v("v-if",!0),T(g(t.step.label||"Text Input")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",Xe,g(t.step.description),1)):v("v-if",!0),u(a,{modelValue:i.currentValue,"onUpdate:modelValue":s[0]||(s[0]=V=>i.currentValue=V),type:(p=t.step.config)!=null&&p.multiline?"textarea":"text",rows:(h=t.step.config)!=null&&h.multiline?3:1,placeholder:t.step.placeholder||"Enter text here...",maxlength:(c=t.step.config)==null?void 0:c.max_length,"show-word-limit":((b=(d=t.step.config)==null?void 0:d.input_style)==null?void 0:b.show_word_limit)!==!1,clearable:((I=(O=t.step.config)==null?void 0:O.input_style)==null?void 0:I.clearable)!==!1,size:((D=(B=t.step.config)==null?void 0:B.input_style)==null?void 0:D.size)||"default",disabled:!t.interactive},null,8,["modelValue","type","rows","placeholder","maxlength","show-word-limit","clearable","size","disabled"]),(L=t.step.config)!=null&&L.max_length?(f(),y("div",Ye,[u(m,null,{default:w(()=>[u(i.InfoFilled)]),_:1}),T(" Maximum "+g(t.step.config.max_length)+" characters ",1)])):v("v-if",!0)])}const zt=q(Ke,[["render",$e],["__scopeId","data-v-b106a4f3"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/TextStepPreview.vue"]]),et={__name:"AttachmentStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){s();const i={props:e,get UploadFilled(){return he},get Files(){return ye},get DocumentAdd(){return fe},get DataAnalysis(){return _e}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},tt={class:"attachment-step-preview"},st={class:"preview-label"},it={key:0,class:"required-asterisk"},rt={key:0,class:"step-description"},nt={class:"upload-config"},at={class:"config-item"},ot={class:"config-item"},lt={class:"config-item"};function ct(e,s,t,i,r,l){var p,h,c,d,b;const a=S("el-icon"),m=S("el-upload");return f(),y("div",tt,[_("div",st,[t.step.required?(f(),y("span",it,"*")):v("v-if",!0),T(g(t.step.label||"File Upload")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",rt,g(t.step.description),1)):v("v-if",!0),_("div",{class:K(["upload-preview",{interactive:t.interactive}])},[u(m,{class:"upload-demo",drag:"",disabled:!t.interactive,"show-file-list":!1,"list-type":((h=(p=t.step.config)==null?void 0:p.upload_style)==null?void 0:h.list_type)||"picture-card"},{default:w(()=>[u(a,{class:"el-icon--upload"},{default:w(()=>[u(i.UploadFilled)]),_:1}),s[0]||(s[0]=_("div",{class:"el-upload__text"},"Add images or files",-1))]),_:1,__:[0]},8,["disabled","list-type"])],2),_("div",nt,[_("div",at,[u(a,null,{default:w(()=>[u(i.Files)]),_:1}),T(" Max "+g(((c=t.step.config)==null?void 0:c.max_files)||5)+" files ",1)]),_("div",ot,[u(a,null,{default:w(()=>[u(i.DocumentAdd)]),_:1}),T(" "+g((((d=t.step.config)==null?void 0:d.allow_types)||["image","pdf"]).join(", ")),1)]),_("div",lt,[u(a,null,{default:w(()=>[u(i.DataAnalysis)]),_:1}),T(" Max "+g(((b=t.step.config)==null?void 0:b.max_file_size_mb)||25)+"MB per file ",1)])])])}const Rt=q(et,[["render",ct],["__scopeId","data-v-b1d80d8a"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/AttachmentStepPreview.vue"]]),dt={__name:"ServiceStepPreview",props:{step:{type:Object,required:!0},previewMode:{type:Boolean,default:!0},interactive:{type:Boolean,default:!1}},setup(e,{expose:s}){var h,c;s();const t=e,i=x(((h=t.step.config)==null?void 0:h.quantity)||1),r=x(((c=t.step.config)==null?void 0:c.status)||"fail");C(()=>{var d;return(d=t.step.config)==null?void 0:d.quantity},d=>{t.interactive||(i.value=d||1)},{immediate:!0}),C(()=>{var d;return(d=t.step.config)==null?void 0:d.status},d=>{t.interactive||(r.value=d||"fail")},{immediate:!0});const p={props:t,currentQuantity:i,currentStatus:r,getServiceTypeTagType:d=>d==="Replace"?"danger":"warning",getStatusButtonType:d=>d===r.value?d==="pass"?"success":"danger":"info",setStatus:d=>{t.interactive&&(r.value=d)},ref:x,watch:C,get Check(){return Z},get Close(){return G}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},ut={class:"service-step-preview"},pt={class:"preview-label"},mt={key:0,class:"required-asterisk"},_t={key:0,class:"step-description"},ft={class:"service-config-preview"},yt={class:"config-row"},ht={class:"config-column"},gt={class:"config-item"},vt={class:"config-item"},bt={class:"config-column"},wt={class:"config-item",style:{width:"100%"}},Tt={class:"config-row"},St={class:"config-item status-row"};function kt(e,s,t,i,r,l){var d;const a=S("el-tag"),m=S("el-input-number"),p=S("el-icon"),h=S("el-button"),c=S("el-button-group");return f(),y("div",ut,[_("div",pt,[t.step.required?(f(),y("span",mt,"*")):v("v-if",!0),T(g(t.step.label||"Service Operation")+": ",1)]),t.step.description&&t.step.description.trim()?(f(),y("div",_t,g(t.step.description),1)):v("v-if",!0),_("div",ft,[v(" First Row "),_("div",yt,[_("div",ht,[_("div",gt,[s[3]||(s[3]=_("span",{class:"config-label"},"Service Type:",-1)),u(a,{type:i.getServiceTypeTagType((d=t.step.config)==null?void 0:d.service_type),size:"small"},{default:w(()=>{var b;return[T(g(((b=t.step.config)==null?void 0:b.service_type)||"Replace"),1)]}),_:1},8,["type"])]),_("div",vt,[s[4]||(s[4]=_("span",{class:"config-label"},"Device Tag:",-1)),u(a,{type:"info",size:"small",class:"device-tag"},{default:w(()=>{var b;return[T(g(((b=t.step.config)==null?void 0:b.device_tag)||"P100016"),1)]}),_:1})])]),_("div",bt,[_("div",wt,[s[5]||(s[5]=_("span",{class:"config-label"},"Quantity:",-1)),u(m,{modelValue:i.currentQuantity,"onUpdate:modelValue":s[0]||(s[0]=b=>i.currentQuantity=b),min:1,max:999,step:1,precision:0,size:"small",disabled:!t.interactive,style:{width:"100%"},class:"quantity-input-preview"},null,8,["modelValue","disabled"])])])]),v(" Second Row "),_("div",Tt,[_("div",St,[u(c,{class:"pass-fail-group"},{default:w(()=>[u(h,{type:i.getStatusButtonType("pass"),size:"small",disabled:!t.interactive,class:"status-button",onClick:s[1]||(s[1]=b=>t.interactive&&i.setStatus("pass"))},{default:w(()=>[u(p,null,{default:w(()=>[u(i.Check)]),_:1}),s[6]||(s[6]=T(" Pass "))]),_:1,__:[6]},8,["type","disabled"]),u(h,{type:i.getStatusButtonType("fail"),size:"small",disabled:!t.interactive,class:"status-button",onClick:s[2]||(s[2]=b=>t.interactive&&i.setStatus("fail"))},{default:w(()=>[u(p,null,{default:w(()=>[u(i.Close)]),_:1}),s[7]||(s[7]=T(" Fail "))]),_:1,__:[7]},8,["type","disabled"])]),_:1})])])])])}const Et=q(dt,[["render",kt],["__scopeId","data-v-bfaa008e"],["__file","/home/erikyu/dev/mes-maintenance-frontend/src/views/taskLibrary/components/Designer/StepCards/ServiceStepPreview.vue"]]);export{Rt as A,Vt as C,H as D,jt as I,Mt as N,Et as S,zt as T,Dt as a,ge as b,ve as c,j as d,ke as e,Bt as f,Lt as u};
