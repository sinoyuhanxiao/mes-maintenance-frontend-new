import"../vue/vue.Dfo81L2Q.js";import{u as h}from"../vue-i18n/vue-i18n.DjO1PVT4.js";import{f as w,E,c as y}from"../element-plus/element-plus.CU5xiOkY.js";import{r as d}from"../@vue/@vue.CVGyaoMH.js";function N(){const{t:o}=h(),u=d(!1),i=d(null),f=(e,t="general",n={})=>{console.error(`Error in ${t}:`,e),i.value=e,u.value=!1;const{showNotification:s=!1,showMessage:a=!0,customMessage:c=null,duration:l=3e3}=n;let r=c;if(!r)if(e.response)switch(e.response.status){case 400:r=o("errors.badRequest");break;case 401:r=o("errors.unauthorized");break;case 403:r=o("errors.forbidden");break;case 404:r=o("errors.notFound");break;case 422:r=o("errors.validationError");break;case 500:r=o("errors.serverError");break;default:r=o("errors.unknownError")}else e.code==="NETWORK_ERROR"?r=o("errors.networkError"):r=e.message||o("errors.unknownError");return s?w({title:o("common.error"),message:r,type:"error",duration:l}):a&&E.error({message:r,duration:l}),{error:e,message:r}};return{loading:u,error:i,handleError:f,handleAsync:async(e,t={})=>{const{loadingRef:n=u,context:s="async operation",onSuccess:a=null,onError:c=null,...l}=t;try{n.value=!0,i.value=null;const r=await e();return a&&a(r),r}catch(r){const m=f(r,s,l);throw c&&c(m),r}finally{n.value=!1}},confirmAction:async(e={})=>{const{title:t=o("common.confirm"),message:n=o("common.confirmMessage"),confirmButtonText:s=o("common.confirm"),cancelButtonText:a=o("common.cancel"),type:c="warning"}=e;try{return await y.confirm(n,t,{confirmButtonText:s,cancelButtonText:a,type:c}),!0}catch{return!1}},showSuccess:(e,t={})=>{const{showNotification:n=!1,duration:s=2e3}=t;n?w({title:o("common.success"),message:e,type:"success",duration:s}):E.success({message:e,duration:s})},clearError:()=>{i.value=null},retry:async(e,t=3,n=1e3)=>{let s;for(let a=0;a<=t;a++)try{return await e()}catch(c){if(s=c,a===t)throw c;await new Promise(l=>setTimeout(l,n))}throw s}}}export{N as u};
